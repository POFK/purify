#include "purify/config.h"
#include <iostream>
#include "catch.hpp"
#include "purify/directories.h"
#include "purify/logging.h"
#include "purify/types.h"
#include "purify/wproj_utilities.h"
using namespace purify;
using namespace purify::notinstalled;

TEST_CASE("wprojection_matrix") {
  //! test if convolution is identity 
  const Vector<t_real> w_components = Vector<t_real>::Random(12);
  const Vector<t_real> w_components_zero = w_components * 0;
  const t_int Nx = 128;
  const t_int Ny = 128;
  const t_int rows = w_components.size();
  const t_int cols = Nx * Ny;

  Sparse<t_complex> I(rows, cols);
  I.reserve(Vector<t_int>::Constant(rows, 1));
  for (t_int i = 0; i < std::min(rows, cols); i++) {
    I.coeffRef(i, i) = 1;
  }

  auto const G_id = wproj_utilities::wprojection_matrix(I, Nx, Ny,
      w_components_zero, 10, 10, 0.9, 0.9);
  auto const G = wproj_utilities::wprojection_matrix(I, Nx, Ny,
      w_components, 10, 10, 0.9, 0.9);
  //Testing if G_id == I
  CHECK(G_id.nonZeros() == I.nonZeros());
  CHECK(G.nonZeros() >= I.nonZeros());
  for (t_int k = 0; k < G.outerSize(); ++k)
    for (Sparse<t_complex>::InnerIterator it(G_id, k); it; ++it)
    {
      CHECK(it.value() == 1.);
      CHECK(it.row() == it.col());   // row index
    }
}

TEST_CASE("convolution"){

  SECTION("Dataset 1"){
  //Testing row-wise convolution
  const t_int Nx = 32;
  const t_int Ny = 32;
  const std::vector<t_real> grid_ind = {0.000000000000E+00,
1.000000000000E+00,
2.000000000000E+00,
3.000000000000E+00,
4.000000000000E+00,
5.000000000000E+00,
3.000000000000E+01,
3.100000000000E+01,
3.200000000000E+01,
3.300000000000E+01,
3.400000000000E+01,
3.500000000000E+01,
3.600000000000E+01,
3.700000000000E+01,
6.200000000000E+01,
6.300000000000E+01,
6.400000000000E+01,
6.500000000000E+01,
6.600000000000E+01,
6.700000000000E+01,
6.800000000000E+01,
6.900000000000E+01,
9.400000000000E+01,
9.500000000000E+01,
9.600000000000E+01,
9.700000000000E+01,
9.800000000000E+01,
9.900000000000E+01,
1.000000000000E+02,
1.010000000000E+02,
1.260000000000E+02,
1.270000000000E+02,
1.280000000000E+02,
1.290000000000E+02,
1.300000000000E+02,
1.310000000000E+02,
1.320000000000E+02,
1.330000000000E+02,
1.580000000000E+02,
1.590000000000E+02,
1.600000000000E+02,
1.610000000000E+02,
1.620000000000E+02,
1.630000000000E+02,
1.640000000000E+02,
1.650000000000E+02,
1.900000000000E+02,
1.910000000000E+02,
9.600000000000E+02,
9.610000000000E+02,
9.620000000000E+02,
9.630000000000E+02,
9.640000000000E+02,
9.650000000000E+02,
9.900000000000E+02,
9.910000000000E+02,
9.920000000000E+02,
9.930000000000E+02,
9.940000000000E+02,
9.950000000000E+02,
9.960000000000E+02,
9.970000000000E+02,
1.022000000000E+03,
1.023000000000E+03};

  const std::vector<t_real> grid_values = {1.602306031603E-02   ,
-9.650499933170E-02 ,
1.636074174375E-01  ,
-8.726908321997E-02 ,
1.280523010326E-02  ,
-2.863864798048E-04 ,
5.151364133130E-08  ,
-4.428289641470E-04 ,
-7.148890355882E-02 ,
4.305692204918E-01  ,
-7.299551181863E-01 ,
3.893620164268E-01  ,
-5.713214840640E-02 ,
1.277749383171E-03  ,
-2.298346049045E-07 ,
1.975737249100E-03  ,
9.411868929764E-02  ,
-5.668657465317E-01 ,
9.610221383977E-01  ,
-5.126144174001E-01 ,
7.521730866028E-02  ,
-1.682220473503E-03 ,
3.025886633029E-07  ,
-2.601156137873E-03 ,
-3.869677258105E-02 ,
2.330660896493E-01  ,
-3.951229603009E-01 ,
2.107607286069E-01  ,
-3.092549534111E-02 ,
6.916426862729E-04  ,
-1.244089221473E-07 ,
1.069461849354E-03  ,
4.073595943602E-03  ,
-2.453478711689E-02 ,
4.159445816663E-02  ,
-2.218670942972E-02 ,
3.255516260731E-03  ,
-7.280898776048E-05 ,
1.309648445605E-08  ,
-1.125818811438E-04 ,
-4.902802231119E-05 ,
2.952899862483E-04  ,
-5.006127390269E-04 ,
2.670295483382E-04  ,
-3.918197240850E-05 ,
8.762971894605E-07  ,
-1.576235692001E-10 ,
1.354986370021E-06  ,
9.509174388334E-07  ,
-5.727263393454E-06 ,
9.709577527343E-06  ,
-5.179141279387E-06 ,
7.599494961196E-07  ,
-1.699612262085E-08 ,
3.057170035784E-12  ,
-2.628048425971E-08 ,
-7.156700529067E-04 ,
4.310396179959E-03  ,
-7.307525952222E-03 ,
3.897873950001E-03  ,
-5.719456536222E-04 ,
1.279145326243E-05  ,
-2.300856995470E-09 ,
1.977895744938E-05 };
  const std::vector<t_real> chirp_ind ={2.370000000000E+02  ,
2.380000000000E+02  ,
2.390000000000E+02  ,
2.400000000000E+02  ,
2.410000000000E+02  ,
2.420000000000E+02  ,
2.430000000000E+02  ,
2.670000000000E+02  ,
2.680000000000E+02  ,
2.690000000000E+02  ,
2.700000000000E+02  ,
2.710000000000E+02  ,
2.720000000000E+02  ,
2.730000000000E+02  ,
2.740000000000E+02  ,
2.750000000000E+02  ,
2.760000000000E+02  ,
2.770000000000E+02  ,
2.980000000000E+02  ,
2.990000000000E+02  ,
3.000000000000E+02  ,
3.010000000000E+02  ,
3.020000000000E+02  ,
3.030000000000E+02  ,
3.040000000000E+02  ,
3.050000000000E+02  ,
3.060000000000E+02  ,
3.070000000000E+02  ,
3.080000000000E+02  ,
3.090000000000E+02  ,
3.100000000000E+02  ,
3.290000000000E+02  ,
3.300000000000E+02  ,
3.310000000000E+02  ,
3.320000000000E+02  ,
3.330000000000E+02  ,
3.340000000000E+02  ,
3.350000000000E+02  ,
3.360000000000E+02  ,
3.370000000000E+02  ,
3.380000000000E+02  ,
3.390000000000E+02  ,
3.400000000000E+02  ,
3.410000000000E+02  ,
3.420000000000E+02  ,
3.430000000000E+02  ,
3.600000000000E+02  ,
3.610000000000E+02  ,
3.620000000000E+02  ,
3.630000000000E+02  ,
3.640000000000E+02  ,
3.650000000000E+02  ,
3.660000000000E+02  ,
3.670000000000E+02  ,
3.680000000000E+02  ,
3.690000000000E+02  ,
3.700000000000E+02  ,
3.710000000000E+02  ,
3.720000000000E+02  ,
3.730000000000E+02  ,
3.740000000000E+02  ,
3.750000000000E+02  ,
3.760000000000E+02  ,
3.920000000000E+02  ,
3.930000000000E+02  ,
3.940000000000E+02  ,
3.950000000000E+02  ,
3.960000000000E+02  ,
3.970000000000E+02  ,
3.980000000000E+02  ,
3.990000000000E+02  ,
4.000000000000E+02  ,
4.010000000000E+02  ,
4.020000000000E+02  ,
4.030000000000E+02  ,
4.040000000000E+02  ,
4.050000000000E+02  ,
4.060000000000E+02  ,
4.070000000000E+02  ,
4.080000000000E+02  ,
4.230000000000E+02  ,
4.240000000000E+02  ,
4.250000000000E+02  ,
4.260000000000E+02  ,
4.270000000000E+02  ,
4.280000000000E+02  ,
4.290000000000E+02  ,
4.300000000000E+02  ,
4.310000000000E+02  ,
4.320000000000E+02  ,
4.330000000000E+02  ,
4.340000000000E+02  ,
4.350000000000E+02  ,
4.360000000000E+02  ,
4.370000000000E+02  ,
4.380000000000E+02  ,
4.390000000000E+02  ,
4.400000000000E+02  ,
4.410000000000E+02  ,
4.550000000000E+02  ,
4.560000000000E+02  ,
4.570000000000E+02  ,
4.580000000000E+02  ,
4.590000000000E+02  ,
4.600000000000E+02  ,
4.610000000000E+02  ,
4.620000000000E+02  ,
4.630000000000E+02  ,
4.640000000000E+02  ,
4.650000000000E+02  ,
4.660000000000E+02  ,
4.670000000000E+02  ,
4.680000000000E+02  ,
4.690000000000E+02  ,
4.700000000000E+02  ,
4.710000000000E+02  ,
4.720000000000E+02  ,
4.730000000000E+02  ,
4.870000000000E+02  ,
4.880000000000E+02  ,
4.890000000000E+02  ,
4.900000000000E+02  ,
4.910000000000E+02  ,
4.920000000000E+02  ,
4.930000000000E+02  ,
4.940000000000E+02  ,
4.950000000000E+02  ,
4.960000000000E+02  ,
4.970000000000E+02  ,
4.980000000000E+02  ,
4.990000000000E+02  ,
5.000000000000E+02  ,
5.010000000000E+02  ,
5.020000000000E+02  ,
5.030000000000E+02  ,
5.040000000000E+02  ,
5.050000000000E+02  ,
5.190000000000E+02  ,
5.200000000000E+02  ,
5.210000000000E+02  ,
5.220000000000E+02  ,
5.230000000000E+02  ,
5.240000000000E+02  ,
5.250000000000E+02  ,
5.260000000000E+02  ,
5.270000000000E+02  ,
5.280000000000E+02  ,
5.290000000000E+02  ,
5.300000000000E+02  ,
5.310000000000E+02  ,
5.320000000000E+02  ,
5.330000000000E+02  ,
5.340000000000E+02  ,
5.350000000000E+02  ,
5.360000000000E+02  ,
5.370000000000E+02  ,
5.510000000000E+02  ,
5.520000000000E+02  ,
5.530000000000E+02  ,
5.540000000000E+02  ,
5.550000000000E+02  ,
5.560000000000E+02  ,
5.570000000000E+02  ,
5.580000000000E+02  ,
5.590000000000E+02  ,
5.600000000000E+02  ,
5.610000000000E+02  ,
5.620000000000E+02  ,
5.630000000000E+02  ,
5.640000000000E+02  ,
5.650000000000E+02  ,
5.660000000000E+02  ,
5.670000000000E+02  ,
5.680000000000E+02  ,
5.690000000000E+02  ,
5.830000000000E+02  ,
5.840000000000E+02  ,
5.850000000000E+02  ,
5.860000000000E+02  ,
5.870000000000E+02  ,
5.880000000000E+02  ,
5.890000000000E+02  ,
5.900000000000E+02  ,
5.910000000000E+02  ,
5.920000000000E+02  ,
5.930000000000E+02  ,
5.940000000000E+02  ,
5.950000000000E+02  ,
5.960000000000E+02  ,
5.970000000000E+02  ,
5.980000000000E+02  ,
5.990000000000E+02  ,
6.000000000000E+02  ,
6.010000000000E+02  ,
6.150000000000E+02  ,
6.160000000000E+02  ,
6.170000000000E+02  ,
6.180000000000E+02  ,
6.190000000000E+02  ,
6.200000000000E+02  ,
6.210000000000E+02  ,
6.220000000000E+02  ,
6.230000000000E+02  ,
6.240000000000E+02  ,
6.250000000000E+02  ,
6.260000000000E+02  ,
6.270000000000E+02  ,
6.280000000000E+02  ,
6.290000000000E+02  ,
6.300000000000E+02  ,
6.310000000000E+02  ,
6.320000000000E+02  ,
6.330000000000E+02  ,
6.480000000000E+02  ,
6.490000000000E+02  ,
6.500000000000E+02  ,
6.510000000000E+02  ,
6.520000000000E+02  ,
6.530000000000E+02  ,
6.540000000000E+02  ,
6.550000000000E+02  ,
6.560000000000E+02  ,
6.570000000000E+02  ,
6.580000000000E+02  ,
6.590000000000E+02  ,
6.600000000000E+02  ,
6.610000000000E+02  ,
6.620000000000E+02  ,
6.630000000000E+02  ,
6.640000000000E+02  ,
6.800000000000E+02  ,
6.810000000000E+02  ,
6.820000000000E+02  ,
6.830000000000E+02  ,
6.840000000000E+02  ,
6.850000000000E+02  ,
6.860000000000E+02  ,
6.870000000000E+02  ,
6.880000000000E+02  ,
6.890000000000E+02  ,
6.900000000000E+02  ,
6.910000000000E+02  ,
6.920000000000E+02  ,
6.930000000000E+02  ,
6.940000000000E+02  ,
6.950000000000E+02  ,
6.960000000000E+02  ,
7.130000000000E+02  ,
7.140000000000E+02  ,
7.150000000000E+02  ,
7.160000000000E+02  ,
7.170000000000E+02  ,
7.180000000000E+02  ,
7.190000000000E+02  ,
7.200000000000E+02  ,
7.210000000000E+02  ,
7.220000000000E+02  ,
7.230000000000E+02  ,
7.240000000000E+02  ,
7.250000000000E+02  ,
7.260000000000E+02  ,
7.270000000000E+02  ,
7.460000000000E+02  ,
7.470000000000E+02  ,
7.480000000000E+02  ,
7.490000000000E+02  ,
7.500000000000E+02  ,
7.510000000000E+02  ,
7.520000000000E+02  ,
7.530000000000E+02  ,
7.540000000000E+02  ,
7.550000000000E+02  ,
7.560000000000E+02  ,
7.570000000000E+02  ,
7.580000000000E+02  ,
7.790000000000E+02  ,
7.800000000000E+02  ,
7.810000000000E+02  ,
7.820000000000E+02  ,
7.830000000000E+02  ,
7.840000000000E+02  ,
7.850000000000E+02  ,
7.860000000000E+02  ,
7.870000000000E+02  ,
7.880000000000E+02  ,
7.890000000000E+02  ,
8.130000000000E+02  ,
8.140000000000E+02  ,
8.150000000000E+02  ,
8.160000000000E+02  ,
8.170000000000E+02  ,
8.180000000000E+02  ,
8.190000000000E+02};
  const std::vector<t_real> chirp_values = {1.300729765407E-05  ,
2.430083125933E-05  ,
3.535750085041E-05  ,
4.006529739295E-05  ,
3.535750085041E-05  ,
2.430083125933E-05  ,
1.300729765407E-05  ,
1.473919921529E-05  ,
4.539992976248E-05  ,
1.089087698551E-04  ,
2.034683690106E-04  ,
2.960447300569E-04  ,
3.354626279025E-04  ,
2.960447300569E-04  ,
2.034683690106E-04  ,
1.089087698551E-04  ,
4.539992976248E-05  ,
1.473919921529E-05  ,
2.430083125933E-05  ,
9.611165206139E-05  ,
2.960447300569E-04  ,
7.101743888425E-04  ,
1.326780431027E-03  ,
1.930454136228E-03  ,
2.187491118183E-03  ,
1.930454136228E-03  ,
1.326780431027E-03  ,
7.101743888425E-04  ,
2.960447300569E-04  ,
9.611165206139E-05  ,
2.430083125933E-05  ,
2.430083125933E-05  ,
1.234098040867E-04  ,
4.880952435234E-04  ,
1.503439192978E-03  ,
3.606563136016E-03  ,
6.737946999085E-03  ,
9.803655035822E-03  ,
1.110899653824E-02  ,
9.803655035822E-03  ,
6.737946999085E-03  ,
3.606563136016E-03  ,
1.503439192978E-03  ,
4.880952435234E-04  ,
1.234098040867E-04  ,
2.430083125933E-05  ,
1.473919921529E-05  ,
9.611165206139E-05  ,
4.880952435234E-04  ,
1.930454136228E-03  ,
5.946217356472E-03  ,
1.426423390900E-02  ,
2.664909733636E-02  ,
3.877420783172E-02  ,
4.393693362341E-02  ,
3.877420783172E-02  ,
2.664909733636E-02  ,
1.426423390900E-02  ,
5.946217356472E-03  ,
1.930454136228E-03  ,
4.880952435234E-04  ,
9.611165206139E-05  ,
1.473919921529E-05  ,
4.539992976248E-05  ,
2.960447300569E-04  ,
1.503439192978E-03  ,
5.946217356472E-03  ,
1.831563888873E-02  ,
4.393693362341E-02  ,
8.208499862390E-02  ,
1.194329682667E-01  ,
1.353352832366E-01  ,
1.194329682667E-01  ,
8.208499862390E-02  ,
4.393693362341E-02  ,
1.831563888873E-02  ,
5.946217356472E-03  ,
1.503439192978E-03  ,
2.960447300569E-04  ,
4.539992976248E-05  ,
1.300729765407E-05  ,
1.089087698551E-04  ,
7.101743888425E-04  ,
3.606563136016E-03  ,
1.426423390900E-02  ,
4.393693362341E-02  ,
1.053992245619E-01  ,
1.969116752042E-01  ,
2.865047968602E-01  ,
3.246524673584E-01  ,
2.865047968602E-01  ,
1.969116752042E-01  ,
1.053992245619E-01  ,
4.393693362341E-02  ,
1.426423390900E-02  ,
3.606563136016E-03  ,
7.101743888425E-04  ,
1.089087698551E-04  ,
1.300729765407E-05  ,
2.430083125933E-05  ,
2.034683690106E-04  ,
1.326780431027E-03  ,
6.737946999085E-03  ,
2.664909733636E-02  ,
8.208499862390E-02  ,
1.969116752042E-01  ,
3.678794411714E-01  ,
5.352614285190E-01  ,
6.065306597126E-01  ,
5.352614285190E-01  ,
3.678794411714E-01  ,
1.969116752042E-01  ,
8.208499862390E-02  ,
2.664909733636E-02  ,
6.737946999085E-03  ,
1.326780431027E-03  ,
2.034683690106E-04  ,
2.430083125933E-05  ,
3.535750085041E-05  ,
2.960447300569E-04  ,
1.930454136228E-03  ,
9.803655035822E-03  ,
3.877420783172E-02  ,
1.194329682667E-01  ,
2.865047968602E-01  ,
5.352614285190E-01  ,
7.788007830714E-01  ,
8.824969025846E-01  ,
7.788007830714E-01  ,
5.352614285190E-01  ,
2.865047968602E-01  ,
1.194329682667E-01  ,
3.877420783172E-02  ,
9.803655035822E-03  ,
1.930454136228E-03  ,
2.960447300569E-04  ,
3.535750085041E-05  ,
4.006529739295E-05  ,
3.354626279025E-04  ,
2.187491118183E-03  ,
1.110899653824E-02  ,
4.393693362341E-02  ,
1.353352832366E-01  ,
3.246524673584E-01  ,
6.065306597126E-01  ,
8.824969025846E-01  ,
1.000000000000E+00  ,
8.824969025846E-01  ,
6.065306597126E-01  ,
3.246524673584E-01  ,
1.353352832366E-01  ,
4.393693362341E-02  ,
1.110899653824E-02  ,
2.187491118183E-03  ,
3.354626279025E-04  ,
4.006529739295E-05  ,
3.535750085041E-05  ,
2.960447300569E-04  ,
1.930454136228E-03  ,
9.803655035822E-03  ,
3.877420783172E-02  ,
1.194329682667E-01  ,
2.865047968602E-01  ,
5.352614285190E-01  ,
7.788007830714E-01  ,
8.824969025846E-01  ,
7.788007830714E-01  ,
5.352614285190E-01  ,
2.865047968602E-01  ,
1.194329682667E-01  ,
3.877420783172E-02  ,
9.803655035822E-03  ,
1.930454136228E-03  ,
2.960447300569E-04  ,
3.535750085041E-05  ,
2.430083125933E-05  ,
2.034683690106E-04  ,
1.326780431027E-03  ,
6.737946999085E-03  ,
2.664909733636E-02  ,
8.208499862390E-02  ,
1.969116752042E-01  ,
3.678794411714E-01  ,
5.352614285190E-01  ,
6.065306597126E-01  ,
5.352614285190E-01  ,
3.678794411714E-01  ,
1.969116752042E-01  ,
8.208499862390E-02  ,
2.664909733636E-02  ,
6.737946999085E-03  ,
1.326780431027E-03  ,
2.034683690106E-04  ,
2.430083125933E-05  ,
1.300729765407E-05  ,
1.089087698551E-04  ,
7.101743888425E-04  ,
3.606563136016E-03  ,
1.426423390900E-02  ,
4.393693362341E-02  ,
1.053992245619E-01  ,
1.969116752042E-01  ,
2.865047968602E-01  ,
3.246524673584E-01  ,
2.865047968602E-01  ,
1.969116752042E-01  ,
1.053992245619E-01  ,
4.393693362341E-02  ,
1.426423390900E-02  ,
3.606563136016E-03  ,
7.101743888425E-04  ,
1.089087698551E-04  ,
1.300729765407E-05  ,
4.539992976248E-05  ,
2.960447300569E-04  ,
1.503439192978E-03  ,
5.946217356472E-03  ,
1.831563888873E-02  ,
4.393693362341E-02  ,
8.208499862390E-02  ,
1.194329682667E-01  ,
1.353352832366E-01  ,
1.194329682667E-01  ,
8.208499862390E-02  ,
4.393693362341E-02  ,
1.831563888873E-02  ,
5.946217356472E-03  ,
1.503439192978E-03  ,
2.960447300569E-04  ,
4.539992976248E-05  ,
1.473919921529E-05  ,
9.611165206139E-05  ,
4.880952435234E-04  ,
1.930454136228E-03  ,
5.946217356472E-03  ,
1.426423390900E-02  ,
2.664909733636E-02  ,
3.877420783172E-02  ,
4.393693362341E-02  ,
3.877420783172E-02  ,
2.664909733636E-02  ,
1.426423390900E-02  ,
5.946217356472E-03  ,
1.930454136228E-03  ,
4.880952435234E-04  ,
9.611165206139E-05  ,
1.473919921529E-05  ,
2.430083125933E-05  ,
1.234098040867E-04  ,
4.880952435234E-04  ,
1.503439192978E-03  ,
3.606563136016E-03  ,
6.737946999085E-03  ,
9.803655035822E-03  ,
1.110899653824E-02  ,
9.803655035822E-03  ,
6.737946999085E-03  ,
3.606563136016E-03  ,
1.503439192978E-03  ,
4.880952435234E-04  ,
1.234098040867E-04  ,
2.430083125933E-05  ,
2.430083125933E-05  ,
9.611165206139E-05  ,
2.960447300569E-04  ,
7.101743888425E-04  ,
1.326780431027E-03  ,
1.930454136228E-03  ,
2.187491118183E-03  ,
1.930454136228E-03  ,
1.326780431027E-03  ,
7.101743888425E-04  ,
2.960447300569E-04  ,
9.611165206139E-05  ,
2.430083125933E-05  ,
1.473919921529E-05  ,
4.539992976248E-05  ,
1.089087698551E-04  ,
2.034683690106E-04  ,
2.960447300569E-04  ,
3.354626279025E-04  ,
2.960447300569E-04  ,
2.034683690106E-04  ,
1.089087698551E-04  ,
4.539992976248E-05  ,
1.473919921529E-05  ,
1.300729765407E-05  ,
2.430083125933E-05  ,
3.535750085041E-05  ,
4.006529739295E-05  ,
3.535750085041E-05  ,
2.430083125933E-05  ,
1.300729765407E-05};
  Sparse<t_complex> chirp(1, Nx * Ny);
  chirp.reserve(Vector<t_int>::Constant(1, chirp_values.size()));
  Eigen::SparseVector<t_complex> grid(Nx * Ny);
  grid.reserve(grid_values.size());
  for (t_int i = 0; i < grid_ind.size(); ++i)
    grid.coeffRef(static_cast<t_int>(grid_ind[i])) = grid_values[i];

  CHECK(grid.nonZeros() == grid_values.size());
  for (t_int i = 0; i < chirp_ind.size(); ++i)
  {
    chirp.coeffRef(0, static_cast<t_int>(chirp_ind[i])) = chirp_values[i];
  }
  CHECK(chirp.nonZeros() == chirp_values.size());
  auto test_output = wproj_utilities::row_wise_convolution(grid, chirp, Nx, Ny);
  const std::vector<t_real> output_ind = {0.000000000000E+00    ,
1.000000000000E+00  ,
2.000000000000E+00  ,
3.000000000000E+00  ,
4.000000000000E+00  ,
5.000000000000E+00  ,
6.000000000000E+00  ,
7.000000000000E+00  ,
8.000000000000E+00  ,
9.000000000000E+00  ,
1.000000000000E+01  ,
1.100000000000E+01  ,
1.200000000000E+01  ,
1.300000000000E+01  ,
1.400000000000E+01  ,
2.100000000000E+01  ,
2.200000000000E+01  ,
2.300000000000E+01  ,
2.400000000000E+01  ,
2.500000000000E+01  ,
2.600000000000E+01  ,
2.700000000000E+01  ,
2.800000000000E+01  ,
2.900000000000E+01  ,
3.000000000000E+01  ,
3.100000000000E+01  ,
3.200000000000E+01  ,
3.300000000000E+01  ,
3.400000000000E+01  ,
3.500000000000E+01  ,
3.600000000000E+01  ,
3.700000000000E+01  ,
3.800000000000E+01  ,
3.900000000000E+01  ,
4.000000000000E+01  ,
4.100000000000E+01  ,
4.200000000000E+01  ,
4.300000000000E+01  ,
4.400000000000E+01  ,
4.500000000000E+01  ,
4.600000000000E+01  ,
5.300000000000E+01  ,
5.400000000000E+01  ,
5.500000000000E+01  ,
5.600000000000E+01  ,
5.700000000000E+01  ,
5.800000000000E+01  ,
5.900000000000E+01  ,
6.000000000000E+01  ,
6.100000000000E+01  ,
6.200000000000E+01  ,
6.300000000000E+01  ,
6.400000000000E+01  ,
6.500000000000E+01  ,
6.600000000000E+01  ,
6.700000000000E+01  ,
6.800000000000E+01  ,
6.900000000000E+01  ,
7.000000000000E+01  ,
7.100000000000E+01  ,
7.200000000000E+01  ,
7.300000000000E+01  ,
7.400000000000E+01  ,
7.500000000000E+01  ,
7.600000000000E+01  ,
7.700000000000E+01  ,
7.800000000000E+01  ,
8.500000000000E+01  ,
8.600000000000E+01  ,
8.700000000000E+01  ,
8.800000000000E+01  ,
8.900000000000E+01  ,
9.000000000000E+01  ,
9.100000000000E+01  ,
9.200000000000E+01  ,
9.300000000000E+01  ,
9.400000000000E+01  ,
9.500000000000E+01  ,
9.600000000000E+01  ,
9.700000000000E+01  ,
9.800000000000E+01  ,
9.900000000000E+01  ,
1.000000000000E+02  ,
1.010000000000E+02  ,
1.020000000000E+02  ,
1.030000000000E+02  ,
1.040000000000E+02  ,
1.050000000000E+02  ,
1.060000000000E+02  ,
1.070000000000E+02  ,
1.080000000000E+02  ,
1.090000000000E+02  ,
1.100000000000E+02  ,
1.170000000000E+02  ,
1.180000000000E+02  ,
1.190000000000E+02  ,
1.200000000000E+02  ,
1.210000000000E+02  ,
1.220000000000E+02  ,
1.230000000000E+02  ,
1.240000000000E+02  ,
1.250000000000E+02  ,
1.260000000000E+02  ,
1.270000000000E+02  ,
1.280000000000E+02  ,
1.290000000000E+02  ,
1.300000000000E+02  ,
1.310000000000E+02  ,
1.320000000000E+02  ,
1.330000000000E+02  ,
1.340000000000E+02  ,
1.350000000000E+02  ,
1.360000000000E+02  ,
1.370000000000E+02  ,
1.380000000000E+02  ,
1.390000000000E+02  ,
1.400000000000E+02  ,
1.410000000000E+02  ,
1.420000000000E+02  ,
1.490000000000E+02  ,
1.500000000000E+02  ,
1.510000000000E+02  ,
1.520000000000E+02  ,
1.530000000000E+02  ,
1.540000000000E+02  ,
1.550000000000E+02  ,
1.560000000000E+02  ,
1.570000000000E+02  ,
1.580000000000E+02  ,
1.590000000000E+02  ,
1.600000000000E+02  ,
1.610000000000E+02  ,
1.620000000000E+02  ,
1.630000000000E+02  ,
1.640000000000E+02  ,
1.650000000000E+02  ,
1.660000000000E+02  ,
1.670000000000E+02  ,
1.680000000000E+02  ,
1.690000000000E+02  ,
1.700000000000E+02  ,
1.710000000000E+02  ,
1.720000000000E+02  ,
1.730000000000E+02  ,
1.740000000000E+02  ,
1.810000000000E+02  ,
1.820000000000E+02  ,
1.830000000000E+02  ,
1.840000000000E+02  ,
1.850000000000E+02  ,
1.860000000000E+02  ,
1.870000000000E+02  ,
1.880000000000E+02  ,
1.890000000000E+02  ,
1.900000000000E+02  ,
1.910000000000E+02  ,
1.920000000000E+02  ,
1.930000000000E+02  ,
1.940000000000E+02  ,
1.950000000000E+02  ,
1.960000000000E+02  ,
1.970000000000E+02  ,
1.980000000000E+02  ,
1.990000000000E+02  ,
2.000000000000E+02  ,
2.010000000000E+02  ,
2.020000000000E+02  ,
2.030000000000E+02  ,
2.040000000000E+02  ,
2.050000000000E+02  ,
2.060000000000E+02  ,
2.130000000000E+02  ,
2.140000000000E+02  ,
2.150000000000E+02  ,
2.160000000000E+02  ,
2.170000000000E+02  ,
2.180000000000E+02  ,
2.190000000000E+02  ,
2.200000000000E+02  ,
2.210000000000E+02  ,
2.220000000000E+02  ,
2.230000000000E+02  ,
2.240000000000E+02  ,
2.250000000000E+02  ,
2.260000000000E+02  ,
2.270000000000E+02  ,
2.280000000000E+02  ,
2.290000000000E+02  ,
2.300000000000E+02  ,
2.310000000000E+02  ,
2.320000000000E+02  ,
2.330000000000E+02  ,
2.340000000000E+02  ,
2.350000000000E+02  ,
2.360000000000E+02  ,
2.370000000000E+02  ,
2.380000000000E+02  ,
2.450000000000E+02  ,
2.460000000000E+02  ,
2.470000000000E+02  ,
2.480000000000E+02  ,
2.490000000000E+02  ,
2.500000000000E+02  ,
2.510000000000E+02  ,
2.520000000000E+02  ,
2.530000000000E+02  ,
2.540000000000E+02  ,
2.550000000000E+02  ,
2.560000000000E+02  ,
2.570000000000E+02  ,
2.580000000000E+02  ,
2.590000000000E+02  ,
2.600000000000E+02  ,
2.610000000000E+02  ,
2.620000000000E+02  ,
2.630000000000E+02  ,
2.640000000000E+02  ,
2.650000000000E+02  ,
2.660000000000E+02  ,
2.670000000000E+02  ,
2.680000000000E+02  ,
2.690000000000E+02  ,
2.700000000000E+02  ,
2.770000000000E+02  ,
2.780000000000E+02  ,
2.790000000000E+02  ,
2.800000000000E+02  ,
2.810000000000E+02  ,
2.820000000000E+02  ,
2.830000000000E+02  ,
2.840000000000E+02  ,
2.850000000000E+02  ,
2.860000000000E+02  ,
2.870000000000E+02  ,
2.880000000000E+02  ,
2.890000000000E+02  ,
2.900000000000E+02  ,
2.910000000000E+02  ,
2.920000000000E+02  ,
2.930000000000E+02  ,
2.940000000000E+02  ,
2.950000000000E+02  ,
2.960000000000E+02  ,
2.970000000000E+02  ,
2.980000000000E+02  ,
2.990000000000E+02  ,
3.000000000000E+02  ,
3.010000000000E+02  ,
3.100000000000E+02  ,
3.110000000000E+02  ,
3.120000000000E+02  ,
3.130000000000E+02  ,
3.140000000000E+02  ,
3.150000000000E+02  ,
3.160000000000E+02  ,
3.170000000000E+02  ,
3.180000000000E+02  ,
3.190000000000E+02  ,
3.200000000000E+02  ,
3.210000000000E+02  ,
3.220000000000E+02  ,
3.230000000000E+02  ,
3.240000000000E+02  ,
3.250000000000E+02  ,
3.260000000000E+02  ,
3.270000000000E+02  ,
3.280000000000E+02  ,
3.290000000000E+02  ,
3.300000000000E+02  ,
3.310000000000E+02  ,
3.320000000000E+02  ,
3.330000000000E+02  ,
3.420000000000E+02  ,
3.430000000000E+02  ,
3.440000000000E+02  ,
3.450000000000E+02  ,
3.460000000000E+02  ,
3.470000000000E+02  ,
3.480000000000E+02  ,
3.490000000000E+02  ,
3.500000000000E+02  ,
3.510000000000E+02  ,
3.520000000000E+02  ,
3.530000000000E+02  ,
3.540000000000E+02  ,
3.550000000000E+02  ,
3.560000000000E+02  ,
3.570000000000E+02  ,
3.580000000000E+02  ,
3.590000000000E+02  ,
3.600000000000E+02  ,
3.610000000000E+02  ,
3.620000000000E+02  ,
3.630000000000E+02  ,
3.640000000000E+02  ,
3.750000000000E+02  ,
3.760000000000E+02  ,
3.770000000000E+02  ,
3.780000000000E+02  ,
3.790000000000E+02  ,
3.800000000000E+02  ,
3.810000000000E+02  ,
3.820000000000E+02  ,
3.830000000000E+02  ,
3.840000000000E+02  ,
3.850000000000E+02  ,
3.860000000000E+02  ,
3.870000000000E+02  ,
3.880000000000E+02  ,
3.890000000000E+02  ,
3.900000000000E+02  ,
3.910000000000E+02  ,
3.920000000000E+02  ,
3.930000000000E+02  ,
3.940000000000E+02  ,
3.950000000000E+02  ,
4.080000000000E+02  ,
4.090000000000E+02  ,
4.100000000000E+02  ,
4.110000000000E+02  ,
4.120000000000E+02  ,
4.130000000000E+02  ,
4.140000000000E+02  ,
4.150000000000E+02  ,
4.160000000000E+02  ,
4.170000000000E+02  ,
4.180000000000E+02  ,
4.190000000000E+02  ,
4.200000000000E+02  ,
4.210000000000E+02  ,
4.220000000000E+02  ,
4.230000000000E+02  ,
4.240000000000E+02  ,
4.250000000000E+02  ,
4.260000000000E+02  ,
4.410000000000E+02  ,
4.420000000000E+02  ,
4.430000000000E+02  ,
4.440000000000E+02  ,
4.450000000000E+02  ,
4.460000000000E+02  ,
4.470000000000E+02  ,
4.480000000000E+02  ,
4.490000000000E+02  ,
4.500000000000E+02  ,
4.510000000000E+02  ,
4.520000000000E+02  ,
4.530000000000E+02  ,
4.540000000000E+02  ,
4.550000000000E+02  ,
4.560000000000E+02  ,
4.750000000000E+02  ,
4.760000000000E+02  ,
4.770000000000E+02  ,
4.780000000000E+02  ,
4.790000000000E+02  ,
6.720000000000E+02  ,
6.730000000000E+02  ,
6.740000000000E+02  ,
6.750000000000E+02  ,
6.760000000000E+02  ,
6.770000000000E+02  ,
6.780000000000E+02  ,
6.790000000000E+02  ,
6.800000000000E+02  ,
6.990000000000E+02  ,
7.000000000000E+02  ,
7.010000000000E+02  ,
7.020000000000E+02  ,
7.030000000000E+02  ,
7.040000000000E+02  ,
7.050000000000E+02  ,
7.060000000000E+02  ,
7.070000000000E+02  ,
7.080000000000E+02  ,
7.090000000000E+02  ,
7.100000000000E+02  ,
7.110000000000E+02  ,
7.120000000000E+02  ,
7.130000000000E+02  ,
7.140000000000E+02  ,
7.290000000000E+02  ,
7.300000000000E+02  ,
7.310000000000E+02  ,
7.320000000000E+02  ,
7.330000000000E+02  ,
7.340000000000E+02  ,
7.350000000000E+02  ,
7.360000000000E+02  ,
7.370000000000E+02  ,
7.380000000000E+02  ,
7.390000000000E+02  ,
7.400000000000E+02  ,
7.410000000000E+02  ,
7.420000000000E+02  ,
7.430000000000E+02  ,
7.440000000000E+02  ,
7.450000000000E+02  ,
7.460000000000E+02  ,
7.470000000000E+02  ,
7.600000000000E+02  ,
7.610000000000E+02  ,
7.620000000000E+02  ,
7.630000000000E+02  ,
7.640000000000E+02  ,
7.650000000000E+02  ,
7.660000000000E+02  ,
7.670000000000E+02  ,
7.680000000000E+02  ,
7.690000000000E+02  ,
7.700000000000E+02  ,
7.710000000000E+02  ,
7.720000000000E+02  ,
7.730000000000E+02  ,
7.740000000000E+02  ,
7.750000000000E+02  ,
7.760000000000E+02  ,
7.770000000000E+02  ,
7.780000000000E+02  ,
7.790000000000E+02  ,
7.800000000000E+02  ,
7.910000000000E+02  ,
7.920000000000E+02  ,
7.930000000000E+02  ,
7.940000000000E+02  ,
7.950000000000E+02  ,
7.960000000000E+02  ,
7.970000000000E+02  ,
7.980000000000E+02  ,
7.990000000000E+02  ,
8.000000000000E+02  ,
8.010000000000E+02  ,
8.020000000000E+02  ,
8.030000000000E+02  ,
8.040000000000E+02  ,
8.050000000000E+02  ,
8.060000000000E+02  ,
8.070000000000E+02  ,
8.080000000000E+02  ,
8.090000000000E+02  ,
8.100000000000E+02  ,
8.110000000000E+02  ,
8.120000000000E+02  ,
8.130000000000E+02  ,
8.220000000000E+02  ,
8.230000000000E+02  ,
8.240000000000E+02  ,
8.250000000000E+02  ,
8.260000000000E+02  ,
8.270000000000E+02  ,
8.280000000000E+02  ,
8.290000000000E+02  ,
8.300000000000E+02  ,
8.310000000000E+02  ,
8.320000000000E+02  ,
8.330000000000E+02  ,
8.340000000000E+02  ,
8.350000000000E+02  ,
8.360000000000E+02  ,
8.370000000000E+02  ,
8.380000000000E+02  ,
8.390000000000E+02  ,
8.400000000000E+02  ,
8.410000000000E+02  ,
8.420000000000E+02  ,
8.430000000000E+02  ,
8.440000000000E+02  ,
8.450000000000E+02  ,
8.540000000000E+02  ,
8.550000000000E+02  ,
8.560000000000E+02  ,
8.570000000000E+02  ,
8.580000000000E+02  ,
8.590000000000E+02  ,
8.600000000000E+02  ,
8.610000000000E+02  ,
8.620000000000E+02  ,
8.630000000000E+02  ,
8.640000000000E+02  ,
8.650000000000E+02  ,
8.660000000000E+02  ,
8.670000000000E+02  ,
8.680000000000E+02  ,
8.690000000000E+02  ,
8.700000000000E+02  ,
8.710000000000E+02  ,
8.720000000000E+02  ,
8.730000000000E+02  ,
8.740000000000E+02  ,
8.750000000000E+02  ,
8.760000000000E+02  ,
8.770000000000E+02  ,
8.780000000000E+02  ,
8.850000000000E+02  ,
8.860000000000E+02  ,
8.870000000000E+02  ,
8.880000000000E+02  ,
8.890000000000E+02  ,
8.900000000000E+02  ,
8.910000000000E+02  ,
8.920000000000E+02  ,
8.930000000000E+02  ,
8.940000000000E+02  ,
8.950000000000E+02  ,
8.960000000000E+02  ,
8.970000000000E+02  ,
8.980000000000E+02  ,
8.990000000000E+02  ,
9.000000000000E+02  ,
9.010000000000E+02  ,
9.020000000000E+02  ,
9.030000000000E+02  ,
9.040000000000E+02  ,
9.050000000000E+02  ,
9.060000000000E+02  ,
9.070000000000E+02  ,
9.080000000000E+02  ,
9.090000000000E+02  ,
9.100000000000E+02  ,
9.170000000000E+02  ,
9.180000000000E+02  ,
9.190000000000E+02  ,
9.200000000000E+02  ,
9.210000000000E+02  ,
9.220000000000E+02  ,
9.230000000000E+02  ,
9.240000000000E+02  ,
9.250000000000E+02  ,
9.260000000000E+02  ,
9.270000000000E+02  ,
9.280000000000E+02  ,
9.290000000000E+02  ,
9.300000000000E+02  ,
9.310000000000E+02  ,
9.320000000000E+02  ,
9.330000000000E+02  ,
9.340000000000E+02  ,
9.350000000000E+02  ,
9.360000000000E+02  ,
9.370000000000E+02  ,
9.380000000000E+02  ,
9.390000000000E+02  ,
9.400000000000E+02  ,
9.410000000000E+02  ,
9.420000000000E+02  ,
9.490000000000E+02  ,
9.500000000000E+02  ,
9.510000000000E+02  ,
9.520000000000E+02  ,
9.530000000000E+02  ,
9.540000000000E+02  ,
9.550000000000E+02  ,
9.560000000000E+02  ,
9.570000000000E+02  ,
9.580000000000E+02  ,
9.590000000000E+02  ,
9.600000000000E+02  ,
9.610000000000E+02  ,
9.620000000000E+02  ,
9.630000000000E+02  ,
9.640000000000E+02  ,
9.650000000000E+02  ,
9.660000000000E+02  ,
9.670000000000E+02  ,
9.680000000000E+02  ,
9.690000000000E+02  ,
9.700000000000E+02  ,
9.710000000000E+02  ,
9.720000000000E+02  ,
9.730000000000E+02  ,
9.740000000000E+02  ,
9.810000000000E+02  ,
9.820000000000E+02  ,
9.830000000000E+02  ,
9.840000000000E+02  ,
9.850000000000E+02  ,
9.860000000000E+02  ,
9.870000000000E+02  ,
9.880000000000E+02  ,
9.890000000000E+02  ,
9.900000000000E+02  ,
9.910000000000E+02  ,
9.920000000000E+02  ,
9.930000000000E+02  ,
9.940000000000E+02  ,
9.950000000000E+02  ,
9.960000000000E+02  ,
9.970000000000E+02  ,
9.980000000000E+02  ,
9.990000000000E+02  ,
1.000000000000E+03  ,
1.001000000000E+03  ,
1.002000000000E+03  ,
1.003000000000E+03  ,
1.004000000000E+03  ,
1.005000000000E+03  ,
1.006000000000E+03  ,
1.013000000000E+03  ,
1.014000000000E+03  ,
1.015000000000E+03  ,
1.016000000000E+03  ,
1.017000000000E+03  ,
1.018000000000E+03  ,
1.019000000000E+03  ,
1.020000000000E+03  ,
1.021000000000E+03  ,
1.022000000000E+03  ,
1.023000000000E+03};
  const std::vector<t_real> output_values = {-5.058535916141E-04    ,
-2.119128838651E-03 ,
-3.059203711590E-03 ,
-2.432439286752E-03 ,
-9.155329614364E-04 ,
1.905185340618E-04  ,
4.487180664143E-04  ,
2.745051280429E-04  ,
9.542445847747E-05  ,
1.954447403163E-05  ,
1.805351183747E-06  ,
-5.701725284362E-07 ,
9.153501420467E-08  ,
-8.588564725494E-08 ,
2.272772642098E-09  ,
-4.088139733146E-13 ,
3.511474707038E-09  ,
-1.028443179785E-07 ,
4.397322034812E-08  ,
-9.313653612353E-07 ,
3.107582069740E-07  ,
1.617552953661E-05  ,
9.574198857546E-05  ,
3.080025092909E-04  ,
5.821153737236E-04  ,
4.867170615925E-04  ,
6.017393415023E-04  ,
2.520814743767E-03  ,
3.639083041913E-03  ,
2.893513931539E-03  ,
1.089074409021E-03  ,
-2.266317747485E-04 ,
-5.337736417820E-04 ,
-3.265382272026E-04 ,
-1.135116752777E-04 ,
-2.327508189315E-05 ,
-1.991528703934E-06 ,
4.137265577868E-07  ,
3.221258987568E-08  ,
8.146174054189E-08  ,
-2.240547086457E-09 ,
4.030174157533E-13  ,
-3.461108940038E-09 ,
9.643231960526E-08  ,
1.037226363807E-07  ,
8.433843500155E-07  ,
-2.285648798233E-07 ,
-1.926234331858E-05 ,
-1.138896468992E-04 ,
-3.663851165521E-04 ,
-6.924567255619E-04 ,
-5.789754367586E-04 ,
1.700134160662E-03  ,
7.122225460411E-03  ,
1.028174321725E-02  ,
8.175237249869E-03  ,
3.077034321301E-03  ,
-6.403178179762E-04 ,
-1.508106151392E-03 ,
-9.225901591286E-04 ,
-3.207120606657E-04 ,
-6.576139228299E-05 ,
-5.622243579487E-06 ,
1.161207190972E-06  ,
9.513130363989E-08  ,
2.295548883840E-07  ,
-6.316849729282E-09 ,
1.136240549902E-12  ,
-9.758000484823E-09 ,
2.717003851710E-07  ,
2.976093088877E-07  ,
2.375147911781E-06  ,
-6.416606160294E-07 ,
-5.442378337613E-05 ,
-3.217799763963E-04 ,
-1.035172224327E-03 ,
-1.956444016057E-03 ,
-1.635817787416E-03 ,
1.864244944567E-03  ,
7.809720618440E-03  ,
1.127422073951E-02  ,
8.964377674623E-03  ,
3.374054713136E-03  ,
-7.021265043069E-04 ,
-1.653680829229E-03 ,
-1.011646068785E-03 ,
-3.516699058886E-04 ,
-7.210533247402E-05 ,
-6.188344289364E-06 ,
1.312960216481E-06  ,
8.315723424867E-08  ,
2.548178062032E-07  ,
-6.996033038565E-09 ,
1.258408347126E-12  ,
-1.080727850819E-08 ,
3.018116379443E-07  ,
3.029409721674E-07  ,
2.644080374017E-06  ,
-7.247558370977E-07 ,
-5.967410540515E-05 ,
-3.528408676087E-04 ,
-1.135095471058E-03 ,
-2.145295912907E-03 ,
-1.793720231605E-03 ,
1.136037921170E-03  ,
4.759105718455E-03  ,
6.870310861806E-03  ,
5.462733321466E-03  ,
2.056089310256E-03  ,
-4.278634825727E-04 ,
-1.007723870723E-03 ,
-6.164792350043E-04 ,
-2.142989972461E-04 ,
-4.402767922201E-05 ,
-3.241178625409E-06 ,
-9.828182059432E-08 ,
5.298809445528E-07  ,
8.496585660802E-08  ,
-2.690662514181E-09 ,
4.839817291429E-13  ,
-4.154116137361E-09 ,
9.593345429519E-08  ,
7.145285286256E-07  ,
7.128813202912E-07  ,
3.751964550338E-08  ,
-3.643464154688E-05 ,
-2.150134189635E-04 ,
-6.917071186970E-04 ,
-1.307305414074E-03 ,
-1.093061407521E-03 ,
3.184068166602E-04  ,
1.333874225257E-03  ,
1.925599286969E-03  ,
1.531085798052E-03  ,
5.762772877985E-04  ,
-1.199208643589E-04 ,
-2.824431681528E-04 ,
-1.727858503758E-04 ,
-6.007127674881E-05 ,
-1.197237541538E-05 ,
-3.192397167473E-06 ,
3.876202626947E-06  ,
-1.939385966301E-06 ,
3.304424797894E-07  ,
-7.612884946906E-09 ,
1.369364311187E-12  ,
-1.176973587507E-08 ,
4.105551397851E-07  ,
-2.108291092792E-06 ,
4.102015669844E-06  ,
-2.052252894808E-06 ,
-9.919738686077E-06 ,
-6.026830528600E-05 ,
-1.938705706144E-04 ,
-3.664093842722E-04 ,
-3.063614309852E-04 ,
-6.986457978263E-05 ,
-2.926776606353E-04 ,
-4.225135203602E-04 ,
-3.359496728558E-04 ,
-1.264463210073E-04 ,
2.631294429614E-05  ,
6.197336524869E-05  ,
3.791760171670E-05  ,
1.311017951759E-05  ,
2.702269264773E-06  ,
1.966352924455E-06  ,
-3.720727986053E-06 ,
2.081340974039E-06  ,
-3.212993856290E-07 ,
7.258067043502E-09  ,
-1.305541597817E-12 ,
1.122230299948E-08  ,
-4.010881800373E-07 ,
2.286800686746E-06  ,
-3.735809109702E-06 ,
1.534008743632E-06  ,
2.280886874739E-06  ,
1.316410082454E-05  ,
4.254273427541E-05  ,
8.039720238328E-05  ,
6.722159054903E-05  ,
-1.095379006710E-04 ,
-4.588776661270E-04 ,
-6.624421479523E-04 ,
-5.267221333901E-04 ,
-1.982501638590E-04 ,
4.125497433436E-05  ,
9.717045866937E-05  ,
5.934229885638E-05  ,
2.140168296133E-05  ,
1.985210785898E-06  ,
2.931052370982E-06  ,
-7.617626230272E-07 ,
-2.073084026736E-07 ,
4.024802268414E-08  ,
-9.257534255578E-10 ,
1.665194877841E-13  ,
-1.431252734493E-09 ,
5.001988845982E-08  ,
-2.114335620439E-07 ,
-1.002127715504E-06 ,
2.697567037772E-06  ,
1.385062141604E-06  ,
2.137616585302E-05  ,
6.661516480942E-05  ,
1.260551257111E-04  ,
1.053940378392E-04  ,
-5.209290348430E-05 ,
-2.182412760720E-04 ,
-3.150560255689E-04 ,
-2.505079930849E-04 ,
-9.428349304112E-05 ,
1.960032638057E-05  ,
4.617531641230E-05  ,
2.895839490703E-05  ,
6.926884429376E-06  ,
7.530551008815E-06  ,
-4.800092498308E-06 ,
1.967966547237E-06  ,
-3.041475826440E-07 ,
6.474521279509E-09  ,
1.139825837674E-11  ,
-2.050256681882E-15 ,
1.636843602979E-11  ,
1.016081078745E-08  ,
-3.797164792949E-07 ,
2.170669557847E-06  ,
-5.149214135331E-06 ,
7.042573649714E-06  ,
7.210464167309E-06  ,
3.230241356590E-05  ,
5.992929021242E-05  ,
5.010611521347E-05  ,
-1.452227680109E-05 ,
-6.054661097950E-05 ,
-8.740816733606E-05 ,
-6.949773023030E-05 ,
-2.624488756770E-05 ,
5.931433700520E-06  ,
1.237394136124E-05  ,
6.065167675415E-06  ,
7.946035778961E-06  ,
-5.448123279175E-06 ,
3.259477371946E-06  ,
-7.548571502148E-07 ,
5.627396719742E-08  ,
-1.033362344413E-09 ,
1.858755944471E-13  ,
-1.599661667275E-09 ,
7.338334652035E-08  ,
-8.957275667615E-07 ,
3.501383068082E-06  ,
-5.651554799282E-06 ,
7.707121610385E-06  ,
7.302797173873E-06  ,
1.611316748467E-05  ,
1.435259386442E-05  ,
-2.167198054138E-06 ,
-1.037411584422E-05 ,
-1.496621416907E-05 ,
-1.191067532846E-05 ,
-4.094812490742E-06 ,
-1.267939932241E-06 ,
5.072951538987E-06  ,
2.559829042355E-06  ,
-3.898735195620E-06 ,
3.154793518991E-06  ,
-8.819123467705E-07 ,
8.753157470984E-08  ,
-2.262607452131E-09 ,
1.291591884725E-11  ,
-2.323245187465E-15 ,
2.027452003895E-11  ,
-3.329721046923E-09 ,
1.113869986164E-07  ,
-1.024676447716E-06 ,
3.345576769009E-06  ,
-3.822054202480E-06 ,
2.291894339995E-06  ,
5.863339526865E-06  ,
3.761690228697E-07  ,
-5.675747372537E-07 ,
-6.724179968546E-07 ,
-9.838813686013E-07 ,
-7.682005498190E-07 ,
-8.002029607970E-07 ,
2.966450847905E-06  ,
-3.966406621623E-06 ,
5.604697024595E-07  ,
1.566307660083E-06  ,
-6.692519766103E-07 ,
8.438953550108E-08  ,
-2.613329761164E-09 ,
2.129475013410E-11  ,
-3.830383757625E-15 ,
3.322609830162E-11  ,
-3.760688289676E-09 ,
1.057189562199E-07  ,
-7.574486178436E-07 ,
1.559744065312E-06  ,
9.242561607139E-07  ,
-4.039547172744E-06 ,
2.801819938135E-06  ,
1.103628493204E-07  ,
-2.387875085030E-07 ,
-3.393023515896E-07 ,
-2.755858711796E-07 ,
1.063971168244E-07  ,
-1.174548119451E-06 ,
1.783970990730E-06  ,
-4.284653442337E-07 ,
-1.756252029205E-07 ,
4.766079884624E-08  ,
-1.941078304596E-09 ,
2.129475013410E-11  ,
-3.830383757625E-15 ,
3.310517736834E-11  ,
-2.720010576982E-09 ,
5.779479327769E-08  ,
-1.723697668261E-07 ,
-5.446448980181E-07 ,
1.837627575591E-06  ,
-1.034411079690E-06 ,
1.076169539702E-08  ,
1.188898175061E-07  ,
1.710609924718E-07  ,
1.366247891990E-07  ,
2.930385667095E-08  ,
1.152546297487E-07  ,
-2.090581805370E-07 ,
4.123168028850E-08  ,
1.305331187263E-09  ,
-5.377270661241E-10 ,
1.291591884725E-11  ,
-2.323245187465E-15 ,
1.996425794276E-11  ,
-6.609643186656E-10 ,
8.099392085564E-10  ,
5.121468707305E-08  ,
-2.203264808742E-07 ,
8.738446411442E-08  ,
-1.676741329462E-10 ,
-1.590728907724E-09 ,
-2.289538073130E-09 ,
-1.827808902817E-09 ,
-4.217371678812E-10 ,
-1.372846425773E-09 ,
2.552161996381E-09  ,
-4.883568276567E-10 ,
1.139825837674E-11  ,
-2.050256681882E-15 ,
1.762088064830E-11  ,
-6.048003576309E-10 ,
2.697405664729E-09  ,
-1.015052759411E-09 ,
3.252104603521E-12  ,
3.085280187745E-11  ,
4.440647568432E-11  ,
3.545105999813E-11  ,
8.179755344750E-12  ,
2.662688694277E-11  ,
-4.950016816266E-11 ,
9.471869390214E-12  ,
-2.210736258944E-13 ,
3.976552063454E-17  ,
-3.417637894859E-13 ,
1.173033665183E-11  ,
-5.231722523739E-11 ,
1.968734051995E-11  ,
-2.386086033769E-09 ,
-2.296257406824E-08 ,
-3.304895035889E-08 ,
-2.638519021618E-08 ,
-6.044893867238E-09 ,
-2.006272100098E-08 ,
3.719626471510E-08  ,
-7.141338672740E-09 ,
1.226964718715E-10  ,
1.042942424364E-11  ,
-2.505092371961E-13 ,
4.506023819243E-17  ,
-3.872144976732E-13 ,
1.279303444957E-11  ,
2.131096297376E-10  ,
-8.847058697386E-09 ,
3.930090222587E-08  ,
-1.487598250912E-08 ,
8.928232072896E-09  ,
3.277134428713E-07  ,
4.708496528348E-07  ,
3.767840412101E-07  ,
5.481054430925E-08  ,
4.658681258563E-07  ,
-7.907413396867E-07 ,
1.689488066460E-07  ,
2.910431922819E-08  ,
-7.907138898657E-09 ,
2.053696569351E-10  ,
-4.130199078721E-13 ,
7.429177317067E-17  ,
-6.722565733681E-13 ,
3.120046638937E-10  ,
-9.705581776495E-09 ,
2.738364379355E-08  ,
2.114752679628E-07  ,
-8.266433037603E-07 ,
3.758209237272E-07  ,
4.917777590901E-07  ,
7.649022837522E-07  ,
1.114226519121E-06  ,
8.752321709517E-07  ,
7.176085621891E-07  ,
-2.277427925785E-06 ,
3.008778030263E-06  ,
-7.602827256126E-07 ,
-6.830625668128E-07 ,
2.192168583117E-07  ,
-1.693082243775E-08 ,
3.272128635999E-10  ,
-4.130199078721E-13 ,
7.429177317067E-17  ,
-6.941730662523E-13 ,
5.010495451168E-10  ,
-2.205032318785E-08 ,
2.578348846976E-07  ,
-6.789993705322E-07 ,
-1.011585014858E-06 ,
3.038312488061E-06  ,
-2.187419058539E-06 ,
9.308840899077E-07  ,
5.604946376573E-06  ,
8.078208694040E-06  ,
6.437263998012E-06  ,
1.911824133815E-06  ,
2.398712090019E-06  ,
-5.172496296827E-06 ,
-1.021749864812E-06 ,
2.728311122945E-06  ,
-1.715624054485E-06 ,
3.328504376143E-07  ,
-1.929118571791E-08 ,
3.204104688851E-10  ,
-2.505092371961E-13 ,
4.506023819243E-17  ,
-4.429722009141E-13 ,
4.931043764567E-10  ,
-2.571697392560E-08 ,
4.020204053551E-07  ,
-1.865701358251E-06 ,
2.702235686891E-06  ,
-6.801248197820E-07 ,
-5.665656560797E-06 ,
1.357863854629E-06  ,
4.083925684628E-06  ,
1.640731669256E-05  ,
2.369124398737E-05  ,
1.883162322887E-05  ,
7.298057440361E-06  ,
-2.661827477108E-06 ,
-2.083971304063E-06 ,
-2.874160680884E-07 ,
-6.029919083756E-06 ,
4.641548193673E-06  ,
-1.958148465485E-06 ,
3.155738490201E-07  ,
-1.413057270321E-08 ,
1.877641551148E-10  ,
-3.377399431723E-14 ,
2.913644521753E-10  ,
-1.937348207876E-08 ,
3.871229545269E-07  ,
-2.174111428768E-06 ,
4.861729808906E-06  ,
-5.866710620552E-06 ,
-9.157002780901E-07 ,
-3.008089660777E-06 ,
-4.851655618152E-06 ,
1.206925230868E-06  ,
5.129874588160E-06  ,
7.404987939012E-06  ,
5.888477153785E-06  ,
2.194213617870E-06  ,
-3.392356522726E-07 ,
-1.114426127277E-06 ,
-1.902913929027E-06 ,
3.989693254390E-06  ,
-6.355298923838E-06 ,
4.470518071599E-06  ,
-1.439966194364E-06 ,
1.700880100868E-07  ,
-3.632342436242E-09 ,
-2.210736258944E-13 ,
3.976552063454E-17  ,
3.133059472676E-13  ,
-5.620787447169E-09 ,
2.149932862038E-07  ,
-1.641529263781E-06 ,
4.746068834204E-06  ,
-6.314155811293E-06 ,
3.704686797769E-06  ,
-1.802402158999E-06 ,
-1.474176662129E-06 ,
-1.066102241937E-06 ,
-4.664170382034E-05 ,
-1.953929568573E-04 ,
-2.820719691019E-04 ,
-2.242815537955E-04 ,
-8.441588195427E-05 ,
1.756554724522E-05  ,
4.135576882137E-05  ,
2.559241366378E-05  ,
7.223363051240E-06  ,
5.691623308509E-06  ,
-4.148721580800E-06 ,
1.876366102451E-06  ,
-2.660802397631E-07 ,
-2.002800503256E-10 ,
1.659692201047E-10  ,
-2.985364002636E-14 ,
2.553333254203E-10  ,
1.878194164990E-09  ,
-3.384783307843E-07 ,
2.065869157421E-06  ,
-4.393182148246E-06 ,
5.203183138074E-06  ,
7.422509435149E-06  ,
2.863238887716E-05  ,
5.366045816169E-05  ,
4.487633494097E-05  ,
-2.297321160140E-04 ,
-9.623969470222E-04 ,
-1.389329548376E-03 ,
-1.104686086419E-03 ,
-4.157869549566E-04 ,
8.652350029636E-05  ,
2.037848841317E-04  ,
1.246413431011E-04  ,
4.359017410426E-05  ,
8.074633389774E-06  ,
8.694893295871E-07  ,
1.496840965917E-06  ,
-1.200343354895E-06 ,
1.573123294471E-07  ,
-3.414872180050E-09 ,
6.142486223344E-13  ,
-5.281123770868E-09 ,
1.981985424065E-07  ,
-1.336808308711E-06 ,
1.247492543039E-06  ,
3.453920229026E-07  ,
6.575968112947E-06  ,
4.369723211808E-05  ,
1.398594839661E-04  ,
2.643667032600E-04  ,
2.210413065390E-04  ,
-5.856497766899E-04 ,
-2.453412117077E-03 ,
-3.541779677446E-03 ,
-2.816145913984E-03 ,
-1.059954269983E-03 ,
2.205719970733E-04  ,
5.195013664909E-04  ,
3.178077596531E-04  ,
1.104722578106E-04  ,
2.230258894997E-05  ,
4.455105534986E-06  ,
-4.851165266464E-06 ,
2.373494309765E-06  ,
-4.336590129815E-07 ,
1.011222989841E-08  ,
-1.818932878400E-12 ,
1.563284619785E-08  ,
-5.372005661921E-07 ,
2.556645066012E-06  ,
-5.260557836664E-06 ,
2.483352863833E-06  ,
1.847753410202E-05  ,
1.108389670291E-04  ,
3.565890122144E-04  ,
6.739415162006E-04  ,
5.634945430027E-04  ,
-8.552400487084E-04 ,
-3.582783400637E-03 ,
-5.172155688292E-03 ,
-4.112493275860E-03 ,
-1.547879598986E-03 ,
3.221071927769E-04  ,
7.586417638202E-04  ,
4.641022240544E-04  ,
1.613264367665E-04  ,
3.328235853287E-05  ,
1.609425791442E-06  ,
1.484298601194E-06  ,
-1.151554537877E-06 ,
4.649107466491E-08  ,
-4.447880310903E-10 ,
8.000605027742E-14  ,
-6.925447453728E-10 ,
6.598986024169E-08  ,
-1.370195784867E-06 ,
8.735292878095E-07  ,
-7.791971617673E-07 ,
2.753846109937E-05  ,
1.618655860705E-04  ,
5.207358092603E-04  ,
9.841748459052E-04  ,
8.228861677851E-04};
  for (t_int i = 0; i < output_ind.size(); ++i)
  {
    CHECK(std::abs(test_output.coeffRef(0, static_cast<t_int>(output_ind[i])) - output_values[i]) <= 1e-12);
  }

  }
  SECTION("Dataset 2"){
  
  //Testing row-wise convolution
  const t_int Nx = 32;
  const t_int Ny = 32;
  const std::vector<t_real> grid_ind = {5.800000000000E+02,
    5.810000000000E+02,
    5.820000000000E+02,
    5.830000000000E+02,
    5.840000000000E+02,
    5.850000000000E+02,
    5.860000000000E+02,
    5.870000000000E+02,
    6.120000000000E+02,
    6.130000000000E+02,
    6.140000000000E+02,
    6.150000000000E+02,
    6.160000000000E+02,
    6.170000000000E+02,
    6.180000000000E+02,
    6.190000000000E+02,
    6.440000000000E+02,
    6.450000000000E+02,
    6.460000000000E+02,
    6.470000000000E+02,
    6.480000000000E+02,
    6.490000000000E+02,
    6.500000000000E+02,
    6.510000000000E+02,
    6.760000000000E+02,
    6.770000000000E+02,
    6.780000000000E+02,
    6.790000000000E+02,
    6.800000000000E+02,
    6.810000000000E+02,
    6.820000000000E+02,
    6.830000000000E+02,
    7.080000000000E+02,
    7.090000000000E+02,
    7.100000000000E+02,
    7.110000000000E+02,
    7.120000000000E+02,
    7.130000000000E+02,
    7.140000000000E+02,
    7.150000000000E+02,
    7.400000000000E+02,
    7.410000000000E+02,
    7.420000000000E+02,
    7.430000000000E+02,
    7.440000000000E+02,
    7.450000000000E+02,
    7.460000000000E+02,
    7.470000000000E+02,
    7.720000000000E+02,
    7.730000000000E+02,
    7.740000000000E+02,
    7.750000000000E+02,
    7.760000000000E+02,
    7.770000000000E+02,
    7.780000000000E+02,
    7.790000000000E+02,
    8.040000000000E+02,
    8.050000000000E+02,
    8.060000000000E+02,
    8.070000000000E+02,
    8.080000000000E+02,
    8.090000000000E+02,
    8.100000000000E+02,
    8.110000000000E+02};

  const std::vector<t_real> grid_values = {4.754972136091E-09,
    -2.677919681207E-07 ,
    2.075856007646E-06,
    -4.312493422250E-06 ,
    2.814072250773E-06,
    -5.276419239891E-07 ,
    1.780973741993E-08,
    -7.406147300136E-12 ,
    -6.005045453883E-06 ,
    3.381939777405E-04,
    -2.621594685491E-03 ,
    5.446239910351E-03,
    -3.553886603907E-03 ,
    6.663580030006E-04,
    -2.249188421456E-05 ,
    9.353209630379E-09,
    1.542780442127E-04,
    -8.688677854484E-03 ,
    6.735244618913E-02,
    -1.399215456627E-01 ,
    9.130433379983E-02,
    -1.711967215534E-02 ,
    5.778480669179E-04,
    -2.402970801750E-07 ,
    -7.522881955962E-04 ,
    4.236759558771E-02,
    -3.284229487817E-01 ,
    6.822832610355E-01,
    -4.452167699876E-01 ,
    8.347867864585E-02,
    -2.817693741250E-03 ,
    1.171732878611E-06,
    1.068801592551E-03,
    -6.019309342054E-02 ,
    4.666017262307E-01,
    -9.693431855429E-01 ,
    6.325347062185E-01,
    -1.186010164762E-01 ,
    4.003193956250E-03,
    -1.664721012552E-06 ,
    -4.758266005124E-04 ,
    2.679774732396E-02,
    -2.077293996687E-01 ,
    4.315480776988E-01,
    -2.816021617705E-01 ,
    5.280074326281E-02,
    -1.782207459897E-03 ,
    7.411277693869E-07,
    5.555053489915E-05,
    -3.128511933413E-03 ,
    2.425143792602E-02,
    -5.038122401113E-02 ,
    3.287573813289E-02,
    -6.164240351766E-03 ,
    2.080644032762E-04,
    -8.652320818912E-08 ,
    -8.182099662432E-07 ,
    4.608019793286E-05,
    -3.572021087254E-04 ,
    7.420706150224E-04,
    -4.842303793612E-04 ,
    9.079377722086E-05,
    -3.064603584647E-06 ,
    1.274409893266E-09};
  const std::vector<t_real> chirp_ind ={2.370000000000E+02,
    2.380000000000E+02,
    2.390000000000E+02,
    2.400000000000E+02,
    2.410000000000E+02,
    2.420000000000E+02,
    2.430000000000E+02,
    2.670000000000E+02,
    2.680000000000E+02,
    2.690000000000E+02,
    2.700000000000E+02,
    2.710000000000E+02,
    2.720000000000E+02,
    2.730000000000E+02,
    2.740000000000E+02,
    2.750000000000E+02,
    2.760000000000E+02,
    2.770000000000E+02,
    2.980000000000E+02,
    2.990000000000E+02,
    3.000000000000E+02,
    3.010000000000E+02,
    3.020000000000E+02,
    3.030000000000E+02,
    3.040000000000E+02,
    3.050000000000E+02,
    3.060000000000E+02,
    3.070000000000E+02,
    3.080000000000E+02,
    3.090000000000E+02,
    3.100000000000E+02,
    3.290000000000E+02,
    3.300000000000E+02,
    3.310000000000E+02,
    3.320000000000E+02,
    3.330000000000E+02,
    3.340000000000E+02,
    3.350000000000E+02,
    3.360000000000E+02,
    3.370000000000E+02,
    3.380000000000E+02,
    3.390000000000E+02,
    3.400000000000E+02,
    3.410000000000E+02,
    3.420000000000E+02,
    3.430000000000E+02,
    3.600000000000E+02,
    3.610000000000E+02,
    3.620000000000E+02,
    3.630000000000E+02,
    3.640000000000E+02,
    3.650000000000E+02,
    3.660000000000E+02,
    3.670000000000E+02,
    3.680000000000E+02,
    3.690000000000E+02,
    3.700000000000E+02,
    3.710000000000E+02,
    3.720000000000E+02,
    3.730000000000E+02,
    3.740000000000E+02,
    3.750000000000E+02,
    3.760000000000E+02,
    3.920000000000E+02,
    3.930000000000E+02,
    3.940000000000E+02,
    3.950000000000E+02,
    3.960000000000E+02,
    3.970000000000E+02,
    3.980000000000E+02,
    3.990000000000E+02,
    4.000000000000E+02,
    4.010000000000E+02,
    4.020000000000E+02,
    4.030000000000E+02,
    4.040000000000E+02,
    4.050000000000E+02,
    4.060000000000E+02,
    4.070000000000E+02,
    4.080000000000E+02,
    4.230000000000E+02,
    4.240000000000E+02,
    4.250000000000E+02,
    4.260000000000E+02,
    4.270000000000E+02,
    4.280000000000E+02,
    4.290000000000E+02,
    4.300000000000E+02,
    4.310000000000E+02,
    4.320000000000E+02,
    4.330000000000E+02,
    4.340000000000E+02,
    4.350000000000E+02,
    4.360000000000E+02,
    4.370000000000E+02,
    4.380000000000E+02,
    4.390000000000E+02,
    4.400000000000E+02,
    4.410000000000E+02,
    4.550000000000E+02,
    4.560000000000E+02,
    4.570000000000E+02,
    4.580000000000E+02,
    4.590000000000E+02,
    4.600000000000E+02,
    4.610000000000E+02,
    4.620000000000E+02,
    4.630000000000E+02,
    4.640000000000E+02,
    4.650000000000E+02,
    4.660000000000E+02,
    4.670000000000E+02,
    4.680000000000E+02,
    4.690000000000E+02,
    4.700000000000E+02,
    4.710000000000E+02,
    4.720000000000E+02,
    4.730000000000E+02,
    4.870000000000E+02,
    4.880000000000E+02,
    4.890000000000E+02,
    4.900000000000E+02,
    4.910000000000E+02,
    4.920000000000E+02,
    4.930000000000E+02,
    4.940000000000E+02,
    4.950000000000E+02,
    4.960000000000E+02,
    4.970000000000E+02,
    4.980000000000E+02,
    4.990000000000E+02,
    5.000000000000E+02,
    5.010000000000E+02,
    5.020000000000E+02,
    5.030000000000E+02,
    5.040000000000E+02,
    5.050000000000E+02,
    5.190000000000E+02,
    5.200000000000E+02,
    5.210000000000E+02,
    5.220000000000E+02,
    5.230000000000E+02,
    5.240000000000E+02,
    5.250000000000E+02,
    5.260000000000E+02,
    5.270000000000E+02,
    5.280000000000E+02,
    5.290000000000E+02,
    5.300000000000E+02,
    5.310000000000E+02,
    5.320000000000E+02,
    5.330000000000E+02,
    5.340000000000E+02,
    5.350000000000E+02,
    5.360000000000E+02,
    5.370000000000E+02,
    5.510000000000E+02,
    5.520000000000E+02,
    5.530000000000E+02,
    5.540000000000E+02,
    5.550000000000E+02,
    5.560000000000E+02,
    5.570000000000E+02,
    5.580000000000E+02,
    5.590000000000E+02,
    5.600000000000E+02,
    5.610000000000E+02,
    5.620000000000E+02,
    5.630000000000E+02,
    5.640000000000E+02,
    5.650000000000E+02,
    5.660000000000E+02,
    5.670000000000E+02,
    5.680000000000E+02,
    5.690000000000E+02,
    5.830000000000E+02,
    5.840000000000E+02,
    5.850000000000E+02,
    5.860000000000E+02,
    5.870000000000E+02,
    5.880000000000E+02,
    5.890000000000E+02,
    5.900000000000E+02,
    5.910000000000E+02,
    5.920000000000E+02,
    5.930000000000E+02,
    5.940000000000E+02,
    5.950000000000E+02,
    5.960000000000E+02,
    5.970000000000E+02,
    5.980000000000E+02,
    5.990000000000E+02,
    6.000000000000E+02,
    6.010000000000E+02,
    6.150000000000E+02,
    6.160000000000E+02,
    6.170000000000E+02,
    6.180000000000E+02,
    6.190000000000E+02,
    6.200000000000E+02,
    6.210000000000E+02,
    6.220000000000E+02,
    6.230000000000E+02,
    6.240000000000E+02,
    6.250000000000E+02,
    6.260000000000E+02,
    6.270000000000E+02,
    6.280000000000E+02,
    6.290000000000E+02,
    6.300000000000E+02,
    6.310000000000E+02,
    6.320000000000E+02,
    6.330000000000E+02,
    6.480000000000E+02,
    6.490000000000E+02,
    6.500000000000E+02,
    6.510000000000E+02,
    6.520000000000E+02,
    6.530000000000E+02,
    6.540000000000E+02,
    6.550000000000E+02,
    6.560000000000E+02,
    6.570000000000E+02,
    6.580000000000E+02,
    6.590000000000E+02,
    6.600000000000E+02,
    6.610000000000E+02,
    6.620000000000E+02,
    6.630000000000E+02,
    6.640000000000E+02,
    6.800000000000E+02,
    6.810000000000E+02,
    6.820000000000E+02,
    6.830000000000E+02,
    6.840000000000E+02,
    6.850000000000E+02,
    6.860000000000E+02,
    6.870000000000E+02,
    6.880000000000E+02,
    6.890000000000E+02,
    6.900000000000E+02,
    6.910000000000E+02,
    6.920000000000E+02,
    6.930000000000E+02,
    6.940000000000E+02,
    6.950000000000E+02,
    6.960000000000E+02,
    7.130000000000E+02,
    7.140000000000E+02,
    7.150000000000E+02,
    7.160000000000E+02,
    7.170000000000E+02,
    7.180000000000E+02,
    7.190000000000E+02,
    7.200000000000E+02,
    7.210000000000E+02,
    7.220000000000E+02,
    7.230000000000E+02,
    7.240000000000E+02,
    7.250000000000E+02,
    7.260000000000E+02,
    7.270000000000E+02,
    7.460000000000E+02,
    7.470000000000E+02,
    7.480000000000E+02,
    7.490000000000E+02,
    7.500000000000E+02,
    7.510000000000E+02,
    7.520000000000E+02,
    7.530000000000E+02,
    7.540000000000E+02,
    7.550000000000E+02,
    7.560000000000E+02,
    7.570000000000E+02,
    7.580000000000E+02,
    7.790000000000E+02,
    7.800000000000E+02,
    7.810000000000E+02,
    7.820000000000E+02,
    7.830000000000E+02,
    7.840000000000E+02,
    7.850000000000E+02,
    7.860000000000E+02,
    7.870000000000E+02,
    7.880000000000E+02,
    7.890000000000E+02,
    8.130000000000E+02,
    8.140000000000E+02,
    8.150000000000E+02,
    8.160000000000E+02,
    8.170000000000E+02,
    8.180000000000E+02,
    8.190000000000E+02};
  const std::vector<t_real> chirp_values = {1.300729765407E-05,
    2.430083125933E-05,
    3.535750085041E-05,
    4.006529739295E-05,
    3.535750085041E-05,
    2.430083125933E-05,
    1.300729765407E-05,
    1.473919921529E-05,
    4.539992976248E-05,
    1.089087698551E-04,
    2.034683690106E-04,
    2.960447300569E-04,
    3.354626279025E-04,
    2.960447300569E-04,
    2.034683690106E-04,
    1.089087698551E-04,
    4.539992976248E-05,
    1.473919921529E-05,
    2.430083125933E-05,
    9.611165206139E-05,
    2.960447300569E-04,
    7.101743888425E-04,
    1.326780431027E-03,
    1.930454136228E-03,
    2.187491118183E-03,
    1.930454136228E-03,
    1.326780431027E-03,
    7.101743888425E-04,
    2.960447300569E-04,
    9.611165206139E-05,
    2.430083125933E-05,
    2.430083125933E-05,
    1.234098040867E-04,
    4.880952435234E-04,
    1.503439192978E-03,
    3.606563136016E-03,
    6.737946999085E-03,
    9.803655035822E-03,
    1.110899653824E-02,
    9.803655035822E-03,
    6.737946999085E-03,
    3.606563136016E-03,
    1.503439192978E-03,
    4.880952435234E-04,
    1.234098040867E-04,
    2.430083125933E-05,
    1.473919921529E-05,
    9.611165206139E-05,
    4.880952435234E-04,
    1.930454136228E-03,
    5.946217356472E-03,
    1.426423390900E-02,
    2.664909733636E-02,
    3.877420783172E-02,
    4.393693362341E-02,
    3.877420783172E-02,
    2.664909733636E-02,
    1.426423390900E-02,
    5.946217356472E-03,
    1.930454136228E-03,
    4.880952435234E-04,
    9.611165206139E-05,
    1.473919921529E-05,
    4.539992976248E-05,
    2.960447300569E-04,
    1.503439192978E-03,
    5.946217356472E-03,
    1.831563888873E-02,
    4.393693362341E-02,
    8.208499862390E-02,
    1.194329682667E-01,
    1.353352832366E-01,
    1.194329682667E-01,
    8.208499862390E-02,
    4.393693362341E-02,
    1.831563888873E-02,
    5.946217356472E-03,
    1.503439192978E-03,
    2.960447300569E-04,
    4.539992976248E-05,
    1.300729765407E-05,
    1.089087698551E-04,
    7.101743888425E-04,
    3.606563136016E-03,
    1.426423390900E-02,
    4.393693362341E-02,
    1.053992245619E-01,
    1.969116752042E-01,
    2.865047968602E-01,
    3.246524673584E-01,
    2.865047968602E-01,
    1.969116752042E-01,
    1.053992245619E-01,
    4.393693362341E-02,
    1.426423390900E-02,
    3.606563136016E-03,
    7.101743888425E-04,
    1.089087698551E-04,
    1.300729765407E-05,
    2.430083125933E-05,
    2.034683690106E-04,
    1.326780431027E-03,
    6.737946999085E-03,
    2.664909733636E-02,
    8.208499862390E-02,
    1.969116752042E-01,
    3.678794411714E-01,
    5.352614285190E-01,
    6.065306597126E-01,
    5.352614285190E-01,
    3.678794411714E-01,
    1.969116752042E-01,
    8.208499862390E-02,
    2.664909733636E-02,
    6.737946999085E-03,
    1.326780431027E-03,
    2.034683690106E-04,
    2.430083125933E-05,
    3.535750085041E-05,
    2.960447300569E-04,
    1.930454136228E-03,
    9.803655035822E-03,
    3.877420783172E-02,
    1.194329682667E-01,
    2.865047968602E-01,
    5.352614285190E-01,
    7.788007830714E-01,
    8.824969025846E-01,
    7.788007830714E-01,
    5.352614285190E-01,
    2.865047968602E-01,
    1.194329682667E-01,
    3.877420783172E-02,
    9.803655035822E-03,
    1.930454136228E-03,
    2.960447300569E-04,
    3.535750085041E-05,
    4.006529739295E-05,
    3.354626279025E-04,
    2.187491118183E-03,
    1.110899653824E-02,
    4.393693362341E-02,
    1.353352832366E-01,
    3.246524673584E-01,
    6.065306597126E-01,
    8.824969025846E-01,
    1.000000000000E+00,
    8.824969025846E-01,
    6.065306597126E-01,
    3.246524673584E-01,
    1.353352832366E-01,
    4.393693362341E-02,
    1.110899653824E-02,
    2.187491118183E-03,
    3.354626279025E-04,
    4.006529739295E-05,
    3.535750085041E-05,
    2.960447300569E-04,
    1.930454136228E-03,
    9.803655035822E-03,
    3.877420783172E-02,
    1.194329682667E-01,
    2.865047968602E-01,
    5.352614285190E-01,
    7.788007830714E-01,
    8.824969025846E-01,
    7.788007830714E-01,
    5.352614285190E-01,
    2.865047968602E-01,
    1.194329682667E-01,
    3.877420783172E-02,
    9.803655035822E-03,
    1.930454136228E-03,
    2.960447300569E-04,
    3.535750085041E-05,
    2.430083125933E-05,
    2.034683690106E-04,
    1.326780431027E-03,
    6.737946999085E-03,
    2.664909733636E-02,
    8.208499862390E-02,
    1.969116752042E-01,
    3.678794411714E-01,
    5.352614285190E-01,
    6.065306597126E-01,
    5.352614285190E-01,
    3.678794411714E-01,
    1.969116752042E-01,
    8.208499862390E-02,
    2.664909733636E-02,
    6.737946999085E-03,
    1.326780431027E-03,
    2.034683690106E-04,
    2.430083125933E-05,
    1.300729765407E-05,
    1.089087698551E-04,
    7.101743888425E-04,
    3.606563136016E-03,
    1.426423390900E-02,
    4.393693362341E-02,
    1.053992245619E-01,
    1.969116752042E-01,
    2.865047968602E-01,
    3.246524673584E-01,
    2.865047968602E-01,
    1.969116752042E-01,
    1.053992245619E-01,
    4.393693362341E-02,
    1.426423390900E-02,
    3.606563136016E-03,
    7.101743888425E-04,
    1.089087698551E-04,
    1.300729765407E-05,
    4.539992976248E-05,
    2.960447300569E-04,
    1.503439192978E-03,
    5.946217356472E-03,
    1.831563888873E-02,
    4.393693362341E-02,
    8.208499862390E-02,
    1.194329682667E-01,
    1.353352832366E-01,
    1.194329682667E-01,
    8.208499862390E-02,
    4.393693362341E-02,
    1.831563888873E-02,
    5.946217356472E-03,
    1.503439192978E-03,
    2.960447300569E-04,
    4.539992976248E-05,
    1.473919921529E-05,
    9.611165206139E-05,
    4.880952435234E-04,
    1.930454136228E-03,
    5.946217356472E-03,
    1.426423390900E-02,
    2.664909733636E-02,
    3.877420783172E-02,
    4.393693362341E-02,
    3.877420783172E-02,
    2.664909733636E-02,
    1.426423390900E-02,
    5.946217356472E-03,
    1.930454136228E-03,
    4.880952435234E-04,
    9.611165206139E-05,
    1.473919921529E-05,
    2.430083125933E-05,
    1.234098040867E-04,
    4.880952435234E-04,
    1.503439192978E-03,
    3.606563136016E-03,
    6.737946999085E-03,
    9.803655035822E-03,
    1.110899653824E-02,
    9.803655035822E-03,
    6.737946999085E-03,
    3.606563136016E-03,
    1.503439192978E-03,
    4.880952435234E-04,
    1.234098040867E-04,
    2.430083125933E-05,
    2.430083125933E-05,
    9.611165206139E-05,
    2.960447300569E-04,
    7.101743888425E-04,
    1.326780431027E-03,
    1.930454136228E-03,
    2.187491118183E-03,
    1.930454136228E-03,
    1.326780431027E-03,
    7.101743888425E-04,
    2.960447300569E-04,
    9.611165206139E-05,
    2.430083125933E-05,
    1.473919921529E-05,
    4.539992976248E-05,
    1.089087698551E-04,
    2.034683690106E-04,
    2.960447300569E-04,
    3.354626279025E-04,
    2.960447300569E-04,
    2.034683690106E-04,
    1.089087698551E-04,
    4.539992976248E-05,
    1.473919921529E-05,
    1.300729765407E-05,
    2.430083125933E-05,
    3.535750085041E-05,
    4.006529739295E-05,
    3.535750085041E-05,
    2.430083125933E-05,
    1.300729765407E-05};
  Sparse<t_complex> chirp(1, Nx * Ny);
  chirp.reserve(Vector<t_int>::Constant(1, chirp_values.size()));
  Eigen::SparseVector<t_complex> grid(Nx * Ny);
  grid.reserve(grid_values.size());
  for (t_int i = 0; i < grid_ind.size(); ++i)
    grid.coeffRef(static_cast<t_int>(grid_ind[i])) = grid_values[i];

  CHECK(grid.nonZeros() == grid_values.size());
  for (t_int i = 0; i < chirp_ind.size(); ++i)
  {
    chirp.coeffRef(0, static_cast<t_int>(chirp_ind[i])) = chirp_values[i];
  }
  CHECK(chirp.nonZeros() == chirp_values.size());
  std::cout << "Testing convolution" << std::endl;
  auto test_output = wproj_utilities::row_wise_convolution(grid, chirp, Nx, Ny);
  std::cout << "Testing output" << std::endl;
  const std::vector<t_real> output_ind = {0.000000000000E+00,
    1.000000000000E+00,
    2.000000000000E+00,
    3.000000000000E+00,
    4.000000000000E+00,
    5.000000000000E+00,
    6.000000000000E+00,
    7.000000000000E+00,
    8.000000000000E+00,
    9.000000000000E+00,
    1.000000000000E+01,
    1.100000000000E+01,
    1.200000000000E+01,
    1.300000000000E+01,
    1.400000000000E+01,
    1.500000000000E+01,
    3.000000000000E+01,
    3.100000000000E+01,
    3.200000000000E+01,
    3.300000000000E+01,
    3.400000000000E+01,
    3.500000000000E+01,
    3.600000000000E+01,
    3.700000000000E+01,
    3.800000000000E+01,
    3.900000000000E+01,
    4.000000000000E+01,
    4.100000000000E+01,
    4.200000000000E+01,
    4.300000000000E+01,
    4.400000000000E+01,
    4.500000000000E+01,
    4.600000000000E+01,
    4.700000000000E+01,
    6.300000000000E+01,
    6.500000000000E+01,
    6.600000000000E+01,
    6.700000000000E+01,
    6.800000000000E+01,
    6.900000000000E+01,
    7.000000000000E+01,
    7.100000000000E+01,
    7.200000000000E+01,
    7.300000000000E+01,
    7.400000000000E+01,
    7.500000000000E+01,
    7.600000000000E+01,
    7.700000000000E+01,
    7.800000000000E+01,
    5.120000000000E+02,
    5.130000000000E+02,
    5.140000000000E+02,
    5.150000000000E+02,
    5.160000000000E+02,
    5.170000000000E+02,
    5.180000000000E+02,
    5.190000000000E+02,
    5.200000000000E+02,
    5.210000000000E+02,
    5.220000000000E+02,
    5.230000000000E+02,
    5.240000000000E+02,
    5.250000000000E+02,
    5.260000000000E+02,
    5.270000000000E+02,
    5.390000000000E+02,
    5.400000000000E+02,
    5.410000000000E+02,
    5.420000000000E+02,
    5.430000000000E+02,
    5.440000000000E+02,
    5.450000000000E+02,
    5.460000000000E+02,
    5.470000000000E+02,
    5.480000000000E+02,
    5.490000000000E+02,
    5.500000000000E+02,
    5.510000000000E+02,
    5.520000000000E+02,
    5.530000000000E+02,
    5.540000000000E+02,
    5.550000000000E+02,
    5.560000000000E+02,
    5.570000000000E+02,
    5.580000000000E+02,
    5.590000000000E+02,
    5.710000000000E+02,
    5.720000000000E+02,
    5.730000000000E+02,
    5.740000000000E+02,
    5.750000000000E+02,
    5.760000000000E+02,
    5.770000000000E+02,
    5.780000000000E+02,
    5.790000000000E+02,
    5.800000000000E+02,
    5.810000000000E+02,
    5.820000000000E+02,
    5.830000000000E+02,
    5.840000000000E+02,
    5.850000000000E+02,
    5.860000000000E+02,
    5.870000000000E+02,
    5.880000000000E+02,
    5.890000000000E+02,
    5.900000000000E+02,
    5.910000000000E+02,
    6.030000000000E+02,
    6.040000000000E+02,
    6.050000000000E+02,
    6.060000000000E+02,
    6.070000000000E+02,
    6.080000000000E+02,
    6.090000000000E+02,
    6.100000000000E+02,
    6.110000000000E+02,
    6.120000000000E+02,
    6.130000000000E+02,
    6.140000000000E+02,
    6.150000000000E+02,
    6.160000000000E+02,
    6.170000000000E+02,
    6.180000000000E+02,
    6.190000000000E+02,
    6.200000000000E+02,
    6.210000000000E+02,
    6.220000000000E+02,
    6.230000000000E+02,
    6.350000000000E+02,
    6.360000000000E+02,
    6.370000000000E+02,
    6.380000000000E+02,
    6.390000000000E+02,
    6.400000000000E+02,
    6.410000000000E+02,
    6.420000000000E+02,
    6.430000000000E+02,
    6.440000000000E+02,
    6.450000000000E+02,
    6.460000000000E+02,
    6.470000000000E+02,
    6.480000000000E+02,
    6.490000000000E+02,
    6.500000000000E+02,
    6.510000000000E+02,
    6.520000000000E+02,
    6.530000000000E+02,
    6.540000000000E+02,
    6.550000000000E+02,
    6.670000000000E+02,
    6.680000000000E+02,
    6.690000000000E+02,
    6.700000000000E+02,
    6.710000000000E+02,
    6.720000000000E+02,
    6.730000000000E+02,
    6.740000000000E+02,
    6.750000000000E+02,
    6.760000000000E+02,
    6.770000000000E+02,
    6.780000000000E+02,
    6.790000000000E+02,
    6.800000000000E+02,
    6.810000000000E+02,
    6.820000000000E+02,
    6.830000000000E+02,
    6.840000000000E+02,
    6.850000000000E+02,
    6.860000000000E+02,
    6.870000000000E+02,
    6.990000000000E+02,
    7.000000000000E+02,
    7.010000000000E+02,
    7.020000000000E+02,
    7.030000000000E+02,
    7.040000000000E+02,
    7.050000000000E+02,
    7.060000000000E+02,
    7.070000000000E+02,
    7.080000000000E+02,
    7.090000000000E+02,
    7.100000000000E+02,
    7.110000000000E+02,
    7.120000000000E+02,
    7.130000000000E+02,
    7.140000000000E+02,
    7.150000000000E+02,
    7.160000000000E+02,
    7.170000000000E+02,
    7.180000000000E+02,
    7.190000000000E+02,
    7.310000000000E+02,
    7.320000000000E+02,
    7.330000000000E+02,
    7.340000000000E+02,
    7.350000000000E+02,
    7.360000000000E+02,
    7.370000000000E+02,
    7.380000000000E+02,
    7.390000000000E+02,
    7.400000000000E+02,
    7.410000000000E+02,
    7.420000000000E+02,
    7.430000000000E+02,
    7.440000000000E+02,
    7.450000000000E+02,
    7.460000000000E+02,
    7.470000000000E+02,
    7.480000000000E+02,
    7.490000000000E+02,
    7.500000000000E+02,
    7.510000000000E+02,
    7.630000000000E+02,
    7.640000000000E+02,
    7.650000000000E+02,
    7.660000000000E+02,
    7.670000000000E+02,
    7.680000000000E+02,
    7.690000000000E+02,
    7.700000000000E+02,
    7.710000000000E+02,
    7.720000000000E+02,
    7.730000000000E+02,
    7.740000000000E+02,
    7.750000000000E+02,
    7.760000000000E+02,
    7.770000000000E+02,
    7.780000000000E+02,
    7.790000000000E+02,
    7.800000000000E+02,
    7.810000000000E+02,
    7.820000000000E+02,
    7.830000000000E+02,
    7.950000000000E+02,
    7.960000000000E+02,
    7.970000000000E+02,
    7.980000000000E+02,
    7.990000000000E+02,
    8.000000000000E+02,
    8.010000000000E+02,
    8.020000000000E+02,
    8.030000000000E+02,
    8.040000000000E+02,
    8.050000000000E+02,
    8.060000000000E+02,
    8.070000000000E+02,
    8.080000000000E+02,
    8.090000000000E+02,
    8.100000000000E+02,
    8.110000000000E+02,
    8.120000000000E+02,
    8.130000000000E+02,
    8.140000000000E+02,
    8.150000000000E+02,
    8.270000000000E+02,
    8.280000000000E+02,
    8.290000000000E+02,
    8.300000000000E+02,
    8.310000000000E+02,
    8.320000000000E+02,
    8.330000000000E+02,
    8.340000000000E+02,
    8.350000000000E+02,
    8.360000000000E+02,
    8.370000000000E+02,
    8.380000000000E+02,
    8.390000000000E+02,
    8.400000000000E+02,
    8.410000000000E+02,
    8.420000000000E+02,
    8.430000000000E+02,
    8.440000000000E+02,
    8.450000000000E+02,
    8.460000000000E+02,
    8.470000000000E+02,
    8.590000000000E+02,
    8.600000000000E+02,
    8.610000000000E+02,
    8.620000000000E+02,
    8.630000000000E+02,
    8.640000000000E+02,
    8.650000000000E+02,
    8.660000000000E+02,
    8.670000000000E+02,
    8.680000000000E+02,
    8.690000000000E+02,
    8.700000000000E+02,
    8.710000000000E+02,
    8.720000000000E+02,
    8.730000000000E+02,
    8.740000000000E+02,
    8.750000000000E+02,
    8.760000000000E+02,
    8.770000000000E+02,
    8.780000000000E+02,
    8.790000000000E+02,
    8.910000000000E+02,
    8.920000000000E+02,
    8.930000000000E+02,
    8.940000000000E+02,
    8.950000000000E+02,
    8.960000000000E+02,
    8.970000000000E+02,
    8.980000000000E+02,
    8.990000000000E+02,
    9.000000000000E+02,
    9.010000000000E+02,
    9.020000000000E+02,
    9.030000000000E+02,
    9.040000000000E+02,
    9.050000000000E+02,
    9.060000000000E+02,
    9.070000000000E+02,
    9.080000000000E+02,
    9.090000000000E+02,
    9.100000000000E+02,
    9.110000000000E+02,
    9.230000000000E+02,
    9.240000000000E+02,
    9.250000000000E+02,
    9.260000000000E+02,
    9.270000000000E+02,
    9.280000000000E+02,
    9.290000000000E+02,
    9.300000000000E+02,
    9.310000000000E+02,
    9.320000000000E+02,
    9.330000000000E+02,
    9.340000000000E+02,
    9.350000000000E+02,
    9.360000000000E+02,
    9.370000000000E+02,
    9.380000000000E+02,
    9.390000000000E+02,
    9.400000000000E+02,
    9.410000000000E+02,
    9.420000000000E+02,
    9.430000000000E+02,
    9.560000000000E+02,
    9.570000000000E+02,
    9.580000000000E+02,
    9.590000000000E+02,
    9.600000000000E+02,
    9.610000000000E+02,
    9.620000000000E+02,
    9.630000000000E+02,
    9.640000000000E+02,
    9.650000000000E+02,
    9.660000000000E+02,
    9.670000000000E+02,
    9.680000000000E+02,
    9.690000000000E+02,
    9.700000000000E+02,
    9.710000000000E+02,
    9.720000000000E+02,
    9.730000000000E+02,
    9.740000000000E+02,
    9.750000000000E+02,
    9.880000000000E+02,
    9.890000000000E+02,
    9.900000000000E+02,
    9.910000000000E+02,
    9.920000000000E+02,
    9.930000000000E+02,
    9.940000000000E+02,
    9.950000000000E+02,
    9.960000000000E+02,
    9.970000000000E+02,
    9.980000000000E+02,
    9.990000000000E+02,
    1.000000000000E+03,
    1.001000000000E+03,
    1.002000000000E+03,
    1.003000000000E+03,
    1.004000000000E+03,
    1.005000000000E+03,
    1.006000000000E+03,
    1.007000000000E+03,
    1.021000000000E+03,
    1.022000000000E+03,
    1.023000000000E+03};
  const std::vector<t_real> output_values = {-4.808346121883E-08,
    2.120356510109E-07,
    3.514643872291E-07,
    -1.868034843778E-06,
    1.440848407517E-06,
    -1.878050428172E-07,
    2.081763266490E-07,
    2.203767174367E-07,
    1.303248851591E-07,
    -1.415360423091E-07,
    1.019395594121E-06,
    -2.027690836813E-06,
    7.441617386207E-07,
    2.003817734770E-07,
    -8.535685582903E-08,
    4.974971970463E-09,
    -1.988318232438E-11,
    1.859918003168E-09,
    6.420385422138E-10,
    -2.539383189662E-09,
    -3.977092795356E-08,
    2.381683386321E-07,
    -1.735240000889E-07,
    -5.079552788940E-08,
    -1.756948656474E-07,
    -1.937952194890E-07,
    -1.126358835315E-07,
    1.428889932609E-08,
    -7.342883906347E-08,
    2.784364929601E-07,
    -7.690846296427E-08,
    -6.443867844480E-10,
    1.198108143765E-09,
    -4.511194463035E-11,
    -1.205975969239E-11,
    -1.064270057445E-11,
    5.794956681466E-10,
    -3.555376896066E-09,
    2.568524012292E-09,
    9.219172321766E-10,
    2.949532087474E-09,
    3.255976426773E-09,
    1.891784144112E-09,
    -2.051234715888E-10,
    9.726344916742E-10,
    -4.200470082090E-09,
    1.106554330811E-09,
    -3.983124179746E-11,
    1.657662881499E-14,
    -6.635413972497E-06,
    -8.110605414060E-06,
    -2.618059912603E-05,
    -3.427738621061E-05,
    1.011225002478E-05,
    1.405133314692E-04,
    2.925232935802E-04,
    3.247452353981E-04,
    1.882402622401E-04,
    4.317855389785E-06,
    -8.811199112327E-05,
    -7.829784687129E-05,
    -3.689408998045E-05,
    -8.638759796677E-06,
    -4.938125743288E-06,
    4.868790444992E-06,
    -7.799386386934E-11,
    -3.444656720775E-10,
    2.278114399514E-07,
    -1.756918202832E-06,
    4.017399331194E-06,
    -8.779424840337E-06,
    -4.194600158315E-05,
    -1.070084152699E-04,
    -1.423532550676E-04,
    4.195412165667E-05,
    5.830667283141E-04,
    1.213834997963E-03,
    1.347541078596E-03,
    7.811091661416E-04,
    1.791811434985E-05,
    -3.656304567613E-04,
    -3.249434239575E-04,
    -1.521686663678E-04,
    -4.174160786686E-05,
    -4.097232456350E-06,
    1.423444533329E-07,
    1.860980970214E-09,
    -1.076260414984E-07,
    9.412434000361E-07,
    -1.382720404659E-06,
    -1.522543410107E-06,
    -2.234919787704E-05,
    -9.688320783788E-05,
    -2.493021800389E-04,
    -3.315250159581E-04,
    9.770741057119E-05,
    1.357910833011E-03,
    2.826914336159E-03,
    3.138303970505E-03,
    1.819134152151E-03,
    4.172970331021E-05,
    -8.515209977544E-04,
    -7.567634688589E-04,
    -3.544297111840E-04,
    -9.670642522165E-05,
    -1.136570703793E-05,
    -7.300173316928E-08,
    -6.248284652699E-09,
    3.410867642800E-07,
    -2.188321309718E-06,
    4.490691845413E-06,
    -5.690191504804E-06,
    -2.990898587171E-05,
    -1.260584996245E-04,
    -3.243762570955E-04,
    -4.313615256868E-04,
    1.271313287478E-04,
    1.766836389397E-03,
    3.678220246434E-03,
    4.083382738601E-03,
    2.366953955355E-03,
    5.429631794279E-05,
    -1.107950720028E-03,
    -9.846576147410E-04,
    -4.611632351315E-04,
    -1.258374597180E-04,
    -1.517012275004E-05,
    3.569616127909E-06,
    8.354522192957E-10,
    -6.083982044221E-08,
    1.051345610061E-06,
    -2.169180982265E-06,
    -2.346475236353E-06,
    -9.803201369696E-06,
    -4.184507669458E-05,
    -1.076660497176E-04,
    -1.431762947328E-04,
    4.219707023192E-05,
    5.864433255445E-04,
    1.220864436769E-03,
    1.355344822569E-03,
    7.856326467574E-04,
    1.802187992643E-05,
    -3.677478620497E-04,
    -3.268247640680E-04,
    -1.530679946601E-04,
    -4.176867968779E-05,
    -4.972375765738E-06,
    6.951249739957E-07,
    -8.464937172342E-10,
    4.309541633468E-08,
    -1.415931357104E-07,
    2.987885683816E-07,
    -1.442998030969E-06,
    3.802777513150E-05,
    1.617708332330E-04,
    4.162423296879E-04,
    5.535267094363E-04,
    -1.631359819509E-04,
    -2.267219198997E-03,
    -4.719922914709E-03,
    -5.239830805710E-03,
    -3.037295067573E-03,
    -6.967348828317E-05,
    1.421731609709E-03,
    1.263520868133E-03,
    5.917685156077E-04,
    1.614786482189E-04,
    1.928847170517E-05,
    -3.191395282541E-06,
    2.118103682802E-09,
    -1.015904896048E-07,
    4.339873734713E-08,
    -1.080798172152E-07,
    4.895459897186E-06,
    7.932618807761E-05,
    3.374506024709E-04,
    8.682729549611E-04,
    1.154645352875E-03,
    -3.402983094317E-04,
    -4.729372706762E-03,
    -9.845662307693E-03,
    -1.093017949545E-02,
    -6.335735160199E-03,
    -1.453374662744E-04,
    2.965702952000E-03,
    2.635678592884E-03,
    1.234416975506E-03,
    3.368411360086E-04,
    4.023587866709E-05,
    -6.661236506459E-06,
    4.409040491963E-09,
    -2.113930245534E-07,
    8.647741393396E-08,
    -2.170355593882E-07,
    1.020633660708E-05,
    7.849778474407E-05,
    3.339421063895E-04,
    8.592451499956E-04,
    1.142640011776E-03,
    -3.367600825033E-04,
    -4.680199397929E-03,
    -9.743292749753E-03,
    -1.081653374891E-02,
    -6.269859814559E-03,
    -1.438263305369E-04,
    2.934867271201E-03,
    2.608274316362E-03,
    1.221582214761E-03,
    3.333388873675E-04,
    3.981569430704E-05,
    -6.577754362178E-06,
    4.395775806138E-09,
    -2.110298182269E-07,
    9.980069337240E-08,
    -2.443253622219E-07,
    1.011949716640E-05,
    4.302276730737E-05,
    1.826242897154E-04,
    4.699070480526E-04,
    6.248910377876E-04,
    -1.841685528882E-04,
    -2.559524109679E-03,
    -5.328446628083E-03,
    -5.915384486768E-03,
    -3.428883258002E-03,
    -7.865625570961E-05,
    1.605030662298E-03,
    1.426422344385E-03,
    6.680632307967E-04,
    1.822967147423E-04,
    2.182206047449E-05,
    -3.965609271439E-06,
    1.560210077751E-09,
    -6.788920421843E-08,
    -3.137792617235E-07,
    6.316245573079E-07,
    5.034846985894E-06,
    7.873828224979E-06,
    3.524890857931E-05,
    9.066653691673E-05,
    1.205699221428E-04,
    -3.553449603564E-05,
    -4.938486940484E-04,
    -1.028099871626E-03,
    -1.141346898253E-03,
    -6.615876414702E-04,
    -1.517637165991E-05,
    3.096834655655E-04,
    2.752217919002E-04,
    1.288998268786E-04,
    3.517603255148E-05,
    3.996700763848E-06,
    9.475114320400E-07,
    4.270584779009E-09,
    -2.366348213465E-07,
    1.671164947745E-06,
    -3.468518697831E-06,
    3.300390832967E-06,
    -5.780401054682E-06,
    -2.512173515044E-05,
    -6.480743434646E-05,
    -8.617492224096E-05,
    2.539759740497E-05,
    3.529688546222E-04,
    7.348146071833E-04,
    8.157557410960E-04,
    4.728570407418E-04,
    1.084701971812E-05,
    -2.213403001003E-04,
    -1.967094520064E-04,
    -9.213085126692E-05,
    -2.509942556733E-05,
    -3.022443728353E-06,
    -9.500420616035E-07,
    -4.868223909215E-09,
    2.708443678607E-07,
    -1.955934829707E-06,
    3.882270493414E-06,
    -2.918098328961E-06,
    -3.554069060069E-06,
    -2.503425816824E-05,
    -6.238115086211E-05,
    -8.310011465483E-05,
    2.448988734191E-05,
    3.403527684878E-04,
    7.085502885520E-04,
    7.865983612328E-04,
    4.559558144502E-04,
    1.045931849740E-05,
    -2.134289703305E-04,
    -1.896805118695E-04,
    -8.878194008305E-05,
    -2.473221235673E-05,
    -1.099470664508E-06,
    -1.952677614408E-06,
    7.026791599516E-10,
    -3.953945289268E-08,
    2.867787740202E-07,
    3.066946220369E-07,
    -2.893060266189E-06,
    -7.900298816413E-06,
    -7.380067699735E-06,
    -2.736150525732E-05,
    -3.535656314082E-05,
    1.045197902416E-05,
    1.450335259439E-04,
    3.019400162172E-04,
    3.351991097855E-04,
    1.942999328269E-04,
    4.455284694041E-06,
    -9.093705920320E-05,
    -8.081834970298E-05,
    -3.829622303706E-05,
    -8.091676936748E-06,
    -6.248678937046E-06,
    5.513336933257E-06,
    -1.064270057445E-11,
    -3.981044064630E-09,
    2.494200756377E-07,
    -1.808685877102E-06,
    4.442714013523E-06,
    5.365789876610E-06,
    -8.028498590720E-06,
    -4.806808208052E-06,
    -8.789652002958E-06,
    2.217547413395E-06,
    3.722979768842E-05,
    7.731116469475E-05,
    8.583060598064E-05,
    4.975131804911E-05,
    1.188121259744E-06,
    -2.363572596560E-05,
    -2.021546876158E-05,
    -8.489463820873E-06,
    -7.251297951515E-06,
    5.945423224607E-06,
    -3.916919784584E-06,
    7.816237253959E-10,
    -5.048587787866E-08,
    6.985276319251E-07,
    -3.183398581553E-06,
    -3.152970851533E-06,
    4.173333418624E-06,
    -2.788147883926E-06,
    -3.882776527209E-06,
    2.659486061842E-06,
    5.195194747067E-06,
    1.176266985825E-05,
    1.304138360843E-05,
    7.563588336049E-06,
    -5.499332490240E-08,
    -1.835980101183E-06,
    -6.059122151169E-06,
    -1.940255945850E-06,
    3.916516539606E-06,
    -3.738570765606E-06,
    1.313368841967E-06,
    -1.205975969239E-11,
    1.950469880573E-09,
    -8.196833536830E-08,
    8.491015931396E-07,
    6.736760226587E-07,
    -1.691466602676E-06,
    -8.910478626014E-08,
    3.952631474868E-06,
    -3.202597701004E-06,
    8.239851334679E-07,
    3.695730699556E-07,
    4.343852738807E-07,
    2.459931340455E-07,
    3.302762978158E-07,
    -2.540632223563E-06,
    4.256809212783E-06,
    -1.205397188838E-06,
    -1.665158287619E-06,
    9.633623249246E-07,
    -1.581152903972E-07,
    -1.988318232438E-11,
    2.368736157677E-09,
    -8.109261432466E-08};
  for (t_int i = 0; i < output_ind.size(); ++i)
  {
    CHECK(std::abs(test_output.coeffRef(0, static_cast<t_int>(output_ind[i])) - output_values[i]) <= 1e-12);
  }

  
  }
}
